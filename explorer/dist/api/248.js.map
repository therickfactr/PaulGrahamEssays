{"version":3,"file":"248.app.js","mappings":"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","sources":["file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/node-gyp-build/node-gyp-build.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/stream.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/limiter.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/bufferutil/index.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/wrapper.mjs","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/subprotocol.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/constants.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/permessage-deflate.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/receiver.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/utf-8-validate/index.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/extension.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/websocket-server.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/bufferutil/fallback.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/node-gyp-build/index.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/sender.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/event-target.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/websocket.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/buffer-util.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/ws/lib/validation.js","file:////Volumes/Data/Repos/bluebook-accounting/PaulGrahamEssays/explorer/node_modules/utf-8-validate/fallback.js"],"sourcesContent":["var fs = require('fs')\nvar path = require('path')\nvar os = require('os')\n\n// Workaround to fix webpack's build warnings: 'the request of a dependency is an expression'\nvar runtimeRequire = typeof __webpack_require__ === 'function' ? __non_webpack_require__ : require // eslint-disable-line\n\nvar vars = (process.config && process.config.variables) || {}\nvar prebuildsOnly = !!process.env.PREBUILDS_ONLY\nvar abi = process.versions.modules // TODO: support old node where this is undef\nvar runtime = isElectron() ? 'electron' : (isNwjs() ? 'node-webkit' : 'node')\n\nvar arch = process.env.npm_config_arch || os.arch()\nvar platform = process.env.npm_config_platform || os.platform()\nvar libc = process.env.LIBC || (isAlpine(platform) ? 'musl' : 'glibc')\nvar armv = process.env.ARM_VERSION || (arch === 'arm64' ? '8' : vars.arm_version) || ''\nvar uv = (process.versions.uv || '').split('.')[0]\n\nmodule.exports = load\n\nfunction load (dir) {\n  return runtimeRequire(load.resolve(dir))\n}\n\nload.resolve = load.path = function (dir) {\n  dir = path.resolve(dir || '.')\n\n  try {\n    var name = runtimeRequire(path.join(dir, 'package.json')).name.toUpperCase().replace(/-/g, '_')\n    if (process.env[name + '_PREBUILD']) dir = process.env[name + '_PREBUILD']\n  } catch (err) {}\n\n  if (!prebuildsOnly) {\n    var release = getFirst(path.join(dir, 'build/Release'), matchBuild)\n    if (release) return release\n\n    var debug = getFirst(path.join(dir, 'build/Debug'), matchBuild)\n    if (debug) return debug\n  }\n\n  var prebuild = resolve(dir)\n  if (prebuild) return prebuild\n\n  var nearby = resolve(path.dirname(process.execPath))\n  if (nearby) return nearby\n\n  var target = [\n    'platform=' + platform,\n    'arch=' + arch,\n    'runtime=' + runtime,\n    'abi=' + abi,\n    'uv=' + uv,\n    armv ? 'armv=' + armv : '',\n    'libc=' + libc,\n    'node=' + process.versions.node,\n    process.versions.electron ? 'electron=' + process.versions.electron : '',\n    typeof __webpack_require__ === 'function' ? 'webpack=true' : '' // eslint-disable-line\n  ].filter(Boolean).join(' ')\n\n  throw new Error('No native build was found for ' + target + '\\n    loaded from: ' + dir + '\\n')\n\n  function resolve (dir) {\n    // Find matching \"prebuilds/<platform>-<arch>\" directory\n    var tuples = readdirSync(path.join(dir, 'prebuilds')).map(parseTuple)\n    var tuple = tuples.filter(matchTuple(platform, arch)).sort(compareTuples)[0]\n    if (!tuple) return\n\n    // Find most specific flavor first\n    var prebuilds = path.join(dir, 'prebuilds', tuple.name)\n    var parsed = readdirSync(prebuilds).map(parseTags)\n    var candidates = parsed.filter(matchTags(runtime, abi))\n    var winner = candidates.sort(compareTags(runtime))[0]\n    if (winner) return path.join(prebuilds, winner.file)\n  }\n}\n\nfunction readdirSync (dir) {\n  try {\n    return fs.readdirSync(dir)\n  } catch (err) {\n    return []\n  }\n}\n\nfunction getFirst (dir, filter) {\n  var files = readdirSync(dir).filter(filter)\n  return files[0] && path.join(dir, files[0])\n}\n\nfunction matchBuild (name) {\n  return /\\.node$/.test(name)\n}\n\nfunction parseTuple (name) {\n  // Example: darwin-x64+arm64\n  var arr = name.split('-')\n  if (arr.length !== 2) return\n\n  var platform = arr[0]\n  var architectures = arr[1].split('+')\n\n  if (!platform) return\n  if (!architectures.length) return\n  if (!architectures.every(Boolean)) return\n\n  return { name, platform, architectures }\n}\n\nfunction matchTuple (platform, arch) {\n  return function (tuple) {\n    if (tuple == null) return false\n    if (tuple.platform !== platform) return false\n    return tuple.architectures.includes(arch)\n  }\n}\n\nfunction compareTuples (a, b) {\n  // Prefer single-arch prebuilds over multi-arch\n  return a.architectures.length - b.architectures.length\n}\n\nfunction parseTags (file) {\n  var arr = file.split('.')\n  var extension = arr.pop()\n  var tags = { file: file, specificity: 0 }\n\n  if (extension !== 'node') return\n\n  for (var i = 0; i < arr.length; i++) {\n    var tag = arr[i]\n\n    if (tag === 'node' || tag === 'electron' || tag === 'node-webkit') {\n      tags.runtime = tag\n    } else if (tag === 'napi') {\n      tags.napi = true\n    } else if (tag.slice(0, 3) === 'abi') {\n      tags.abi = tag.slice(3)\n    } else if (tag.slice(0, 2) === 'uv') {\n      tags.uv = tag.slice(2)\n    } else if (tag.slice(0, 4) === 'armv') {\n      tags.armv = tag.slice(4)\n    } else if (tag === 'glibc' || tag === 'musl') {\n      tags.libc = tag\n    } else {\n      continue\n    }\n\n    tags.specificity++\n  }\n\n  return tags\n}\n\nfunction matchTags (runtime, abi) {\n  return function (tags) {\n    if (tags == null) return false\n    if (tags.runtime && tags.runtime !== runtime && !runtimeAgnostic(tags)) return false\n    if (tags.abi && tags.abi !== abi && !tags.napi) return false\n    if (tags.uv && tags.uv !== uv) return false\n    if (tags.armv && tags.armv !== armv) return false\n    if (tags.libc && tags.libc !== libc) return false\n\n    return true\n  }\n}\n\nfunction runtimeAgnostic (tags) {\n  return tags.runtime === 'node' && tags.napi\n}\n\nfunction compareTags (runtime) {\n  // Precedence: non-agnostic runtime, abi over napi, then by specificity.\n  return function (a, b) {\n    if (a.runtime !== b.runtime) {\n      return a.runtime === runtime ? -1 : 1\n    } else if (a.abi !== b.abi) {\n      return a.abi ? -1 : 1\n    } else if (a.specificity !== b.specificity) {\n      return a.specificity > b.specificity ? -1 : 1\n    } else {\n      return 0\n    }\n  }\n}\n\nfunction isNwjs () {\n  return !!(process.versions && process.versions.nw)\n}\n\nfunction isElectron () {\n  if (process.versions && process.versions.electron) return true\n  if (process.env.ELECTRON_RUN_AS_NODE) return true\n  return typeof window !== 'undefined' && window.process && window.process.type === 'renderer'\n}\n\nfunction isAlpine (platform) {\n  return platform === 'linux' && fs.existsSync('/etc/alpine-release')\n}\n\n// Exposed for unit tests\n// TODO: move to lib\nload.parseTags = parseTags\nload.matchTags = matchTags\nload.compareTags = compareTags\nload.parseTuple = parseTuple\nload.matchTuple = matchTuple\nload.compareTuples = compareTuples\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^WebSocket$\" }] */\n'use strict';\n\nconst WebSocket = require('./websocket');\nconst { Duplex } = require('stream');\n\n/**\n * Emits the `'close'` event on a stream.\n *\n * @param {Duplex} stream The stream.\n * @private\n */\nfunction emitClose(stream) {\n  stream.emit('close');\n}\n\n/**\n * The listener of the `'end'` event.\n *\n * @private\n */\nfunction duplexOnEnd() {\n  if (!this.destroyed && this._writableState.finished) {\n    this.destroy();\n  }\n}\n\n/**\n * The listener of the `'error'` event.\n *\n * @param {Error} err The error\n * @private\n */\nfunction duplexOnError(err) {\n  this.removeListener('error', duplexOnError);\n  this.destroy();\n  if (this.listenerCount('error') === 0) {\n    // Do not suppress the throwing behavior.\n    this.emit('error', err);\n  }\n}\n\n/**\n * Wraps a `WebSocket` in a duplex stream.\n *\n * @param {WebSocket} ws The `WebSocket` to wrap\n * @param {Object} [options] The options for the `Duplex` constructor\n * @return {Duplex} The duplex stream\n * @public\n */\nfunction createWebSocketStream(ws, options) {\n  let terminateOnDestroy = true;\n\n  const duplex = new Duplex({\n    ...options,\n    autoDestroy: false,\n    emitClose: false,\n    objectMode: false,\n    writableObjectMode: false\n  });\n\n  ws.on('message', function message(msg, isBinary) {\n    const data =\n      !isBinary && duplex._readableState.objectMode ? msg.toString() : msg;\n\n    if (!duplex.push(data)) ws.pause();\n  });\n\n  ws.once('error', function error(err) {\n    if (duplex.destroyed) return;\n\n    // Prevent `ws.terminate()` from being called by `duplex._destroy()`.\n    //\n    // - If the `'error'` event is emitted before the `'open'` event, then\n    //   `ws.terminate()` is a noop as no socket is assigned.\n    // - Otherwise, the error is re-emitted by the listener of the `'error'`\n    //   event of the `Receiver` object. The listener already closes the\n    //   connection by calling `ws.close()`. This allows a close frame to be\n    //   sent to the other peer. If `ws.terminate()` is called right after this,\n    //   then the close frame might not be sent.\n    terminateOnDestroy = false;\n    duplex.destroy(err);\n  });\n\n  ws.once('close', function close() {\n    if (duplex.destroyed) return;\n\n    duplex.push(null);\n  });\n\n  duplex._destroy = function (err, callback) {\n    if (ws.readyState === ws.CLOSED) {\n      callback(err);\n      process.nextTick(emitClose, duplex);\n      return;\n    }\n\n    let called = false;\n\n    ws.once('error', function error(err) {\n      called = true;\n      callback(err);\n    });\n\n    ws.once('close', function close() {\n      if (!called) callback(err);\n      process.nextTick(emitClose, duplex);\n    });\n\n    if (terminateOnDestroy) ws.terminate();\n  };\n\n  duplex._final = function (callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._final(callback);\n      });\n      return;\n    }\n\n    // If the value of the `_socket` property is `null` it means that `ws` is a\n    // client websocket and the handshake failed. In fact, when this happens, a\n    // socket is never assigned to the websocket. Wait for the `'error'` event\n    // that will be emitted by the websocket.\n    if (ws._socket === null) return;\n\n    if (ws._socket._writableState.finished) {\n      callback();\n      if (duplex._readableState.endEmitted) duplex.destroy();\n    } else {\n      ws._socket.once('finish', function finish() {\n        // `duplex` is not destroyed here because the `'end'` event will be\n        // emitted on `duplex` after this `'finish'` event. The EOF signaling\n        // `null` chunk is, in fact, pushed when the websocket emits `'close'`.\n        callback();\n      });\n      ws.close();\n    }\n  };\n\n  duplex._read = function () {\n    if (ws.isPaused) ws.resume();\n  };\n\n  duplex._write = function (chunk, encoding, callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._write(chunk, encoding, callback);\n      });\n      return;\n    }\n\n    ws.send(chunk, callback);\n  };\n\n  duplex.on('end', duplexOnEnd);\n  duplex.on('error', duplexOnError);\n  return duplex;\n}\n\nmodule.exports = createWebSocketStream;\n","'use strict';\n\nconst kDone = Symbol('kDone');\nconst kRun = Symbol('kRun');\n\n/**\n * A very simple job queue with adjustable concurrency. Adapted from\n * https://github.com/STRML/async-limiter\n */\nclass Limiter {\n  /**\n   * Creates a new `Limiter`.\n   *\n   * @param {Number} [concurrency=Infinity] The maximum number of jobs allowed\n   *     to run concurrently\n   */\n  constructor(concurrency) {\n    this[kDone] = () => {\n      this.pending--;\n      this[kRun]();\n    };\n    this.concurrency = concurrency || Infinity;\n    this.jobs = [];\n    this.pending = 0;\n  }\n\n  /**\n   * Adds a job to the queue.\n   *\n   * @param {Function} job The job to run\n   * @public\n   */\n  add(job) {\n    this.jobs.push(job);\n    this[kRun]();\n  }\n\n  /**\n   * Removes a job from the queue and runs it if possible.\n   *\n   * @private\n   */\n  [kRun]() {\n    if (this.pending === this.concurrency) return;\n\n    if (this.jobs.length) {\n      const job = this.jobs.shift();\n\n      this.pending++;\n      job(this[kDone]);\n    }\n  }\n}\n\nmodule.exports = Limiter;\n","'use strict';\n\ntry {\n  module.exports = require('node-gyp-build')(__dirname);\n} catch (e) {\n  module.exports = require('./fallback');\n}\n","import createWebSocketStream from './lib/stream.js';\nimport Receiver from './lib/receiver.js';\nimport Sender from './lib/sender.js';\nimport WebSocket from './lib/websocket.js';\nimport WebSocketServer from './lib/websocket-server.js';\n\nexport { createWebSocketStream, Receiver, Sender, WebSocket, WebSocketServer };\nexport default WebSocket;\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Parses the `Sec-WebSocket-Protocol` header into a set of subprotocol names.\n *\n * @param {String} header The field value of the header\n * @return {Set} The subprotocol names\n * @public\n */\nfunction parse(header) {\n  const protocols = new Set();\n  let start = -1;\n  let end = -1;\n  let i = 0;\n\n  for (i; i < header.length; i++) {\n    const code = header.charCodeAt(i);\n\n    if (end === -1 && tokenChars[code] === 1) {\n      if (start === -1) start = i;\n    } else if (\n      i !== 0 &&\n      (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n    ) {\n      if (end === -1 && start !== -1) end = i;\n    } else if (code === 0x2c /* ',' */) {\n      if (start === -1) {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n\n      if (end === -1) end = i;\n\n      const protocol = header.slice(start, end);\n\n      if (protocols.has(protocol)) {\n        throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n      }\n\n      protocols.add(protocol);\n      start = end = -1;\n    } else {\n      throw new SyntaxError(`Unexpected character at index ${i}`);\n    }\n  }\n\n  if (start === -1 || end !== -1) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  const protocol = header.slice(start, i);\n\n  if (protocols.has(protocol)) {\n    throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n  }\n\n  protocols.add(protocol);\n  return protocols;\n}\n\nmodule.exports = { parse };\n","'use strict';\n\nconst BINARY_TYPES = ['nodebuffer', 'arraybuffer', 'fragments'];\nconst hasBlob = typeof Blob !== 'undefined';\n\nif (hasBlob) BINARY_TYPES.push('blob');\n\nmodule.exports = {\n  BINARY_TYPES,\n  EMPTY_BUFFER: Buffer.alloc(0),\n  GUID: '258EAFA5-E914-47DA-95CA-C5AB0DC85B11',\n  hasBlob,\n  kForOnEventAttribute: Symbol('kIsForOnEventAttribute'),\n  kListener: Symbol('kListener'),\n  kStatusCode: Symbol('status-code'),\n  kWebSocket: Symbol('websocket'),\n  NOOP: () => {}\n};\n","'use strict';\n\nconst zlib = require('zlib');\n\nconst bufferUtil = require('./buffer-util');\nconst Limiter = require('./limiter');\nconst { kStatusCode } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\nconst TRAILER = Buffer.from([0x00, 0x00, 0xff, 0xff]);\nconst kPerMessageDeflate = Symbol('permessage-deflate');\nconst kTotalLength = Symbol('total-length');\nconst kCallback = Symbol('callback');\nconst kBuffers = Symbol('buffers');\nconst kError = Symbol('error');\n\n//\n// We limit zlib concurrency, which prevents severe memory fragmentation\n// as documented in https://github.com/nodejs/node/issues/8871#issuecomment-250915913\n// and https://github.com/websockets/ws/issues/1202\n//\n// Intentionally global; it's the global thread pool that's an issue.\n//\nlet zlibLimiter;\n\n/**\n * permessage-deflate implementation.\n */\nclass PerMessageDeflate {\n  /**\n   * Creates a PerMessageDeflate instance.\n   *\n   * @param {Object} [options] Configuration options\n   * @param {(Boolean|Number)} [options.clientMaxWindowBits] Advertise support\n   *     for, or request, a custom client window size\n   * @param {Boolean} [options.clientNoContextTakeover=false] Advertise/\n   *     acknowledge disabling of client context takeover\n   * @param {Number} [options.concurrencyLimit=10] The number of concurrent\n   *     calls to zlib\n   * @param {(Boolean|Number)} [options.serverMaxWindowBits] Request/confirm the\n   *     use of a custom server window size\n   * @param {Boolean} [options.serverNoContextTakeover=false] Request/accept\n   *     disabling of server context takeover\n   * @param {Number} [options.threshold=1024] Size (in bytes) below which\n   *     messages should not be compressed if context takeover is disabled\n   * @param {Object} [options.zlibDeflateOptions] Options to pass to zlib on\n   *     deflate\n   * @param {Object} [options.zlibInflateOptions] Options to pass to zlib on\n   *     inflate\n   * @param {Boolean} [isServer=false] Create the instance in either server or\n   *     client mode\n   * @param {Number} [maxPayload=0] The maximum allowed message length\n   */\n  constructor(options, isServer, maxPayload) {\n    this._maxPayload = maxPayload | 0;\n    this._options = options || {};\n    this._threshold =\n      this._options.threshold !== undefined ? this._options.threshold : 1024;\n    this._isServer = !!isServer;\n    this._deflate = null;\n    this._inflate = null;\n\n    this.params = null;\n\n    if (!zlibLimiter) {\n      const concurrency =\n        this._options.concurrencyLimit !== undefined\n          ? this._options.concurrencyLimit\n          : 10;\n      zlibLimiter = new Limiter(concurrency);\n    }\n  }\n\n  /**\n   * @type {String}\n   */\n  static get extensionName() {\n    return 'permessage-deflate';\n  }\n\n  /**\n   * Create an extension negotiation offer.\n   *\n   * @return {Object} Extension parameters\n   * @public\n   */\n  offer() {\n    const params = {};\n\n    if (this._options.serverNoContextTakeover) {\n      params.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      params.client_no_context_takeover = true;\n    }\n    if (this._options.serverMaxWindowBits) {\n      params.server_max_window_bits = this._options.serverMaxWindowBits;\n    }\n    if (this._options.clientMaxWindowBits) {\n      params.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits == null) {\n      params.client_max_window_bits = true;\n    }\n\n    return params;\n  }\n\n  /**\n   * Accept an extension negotiation offer/response.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Object} Accepted configuration\n   * @public\n   */\n  accept(configurations) {\n    configurations = this.normalizeParams(configurations);\n\n    this.params = this._isServer\n      ? this.acceptAsServer(configurations)\n      : this.acceptAsClient(configurations);\n\n    return this.params;\n  }\n\n  /**\n   * Releases all resources used by the extension.\n   *\n   * @public\n   */\n  cleanup() {\n    if (this._inflate) {\n      this._inflate.close();\n      this._inflate = null;\n    }\n\n    if (this._deflate) {\n      const callback = this._deflate[kCallback];\n\n      this._deflate.close();\n      this._deflate = null;\n\n      if (callback) {\n        callback(\n          new Error(\n            'The deflate stream was closed while data was being processed'\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   *  Accept an extension negotiation offer.\n   *\n   * @param {Array} offers The extension negotiation offers\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsServer(offers) {\n    const opts = this._options;\n    const accepted = offers.find((params) => {\n      if (\n        (opts.serverNoContextTakeover === false &&\n          params.server_no_context_takeover) ||\n        (params.server_max_window_bits &&\n          (opts.serverMaxWindowBits === false ||\n            (typeof opts.serverMaxWindowBits === 'number' &&\n              opts.serverMaxWindowBits > params.server_max_window_bits))) ||\n        (typeof opts.clientMaxWindowBits === 'number' &&\n          !params.client_max_window_bits)\n      ) {\n        return false;\n      }\n\n      return true;\n    });\n\n    if (!accepted) {\n      throw new Error('None of the extension offers can be accepted');\n    }\n\n    if (opts.serverNoContextTakeover) {\n      accepted.server_no_context_takeover = true;\n    }\n    if (opts.clientNoContextTakeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (typeof opts.serverMaxWindowBits === 'number') {\n      accepted.server_max_window_bits = opts.serverMaxWindowBits;\n    }\n    if (typeof opts.clientMaxWindowBits === 'number') {\n      accepted.client_max_window_bits = opts.clientMaxWindowBits;\n    } else if (\n      accepted.client_max_window_bits === true ||\n      opts.clientMaxWindowBits === false\n    ) {\n      delete accepted.client_max_window_bits;\n    }\n\n    return accepted;\n  }\n\n  /**\n   * Accept the extension negotiation response.\n   *\n   * @param {Array} response The extension negotiation response\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsClient(response) {\n    const params = response[0];\n\n    if (\n      this._options.clientNoContextTakeover === false &&\n      params.client_no_context_takeover\n    ) {\n      throw new Error('Unexpected parameter \"client_no_context_takeover\"');\n    }\n\n    if (!params.client_max_window_bits) {\n      if (typeof this._options.clientMaxWindowBits === 'number') {\n        params.client_max_window_bits = this._options.clientMaxWindowBits;\n      }\n    } else if (\n      this._options.clientMaxWindowBits === false ||\n      (typeof this._options.clientMaxWindowBits === 'number' &&\n        params.client_max_window_bits > this._options.clientMaxWindowBits)\n    ) {\n      throw new Error(\n        'Unexpected or invalid parameter \"client_max_window_bits\"'\n      );\n    }\n\n    return params;\n  }\n\n  /**\n   * Normalize parameters.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Array} The offers/response with normalized parameters\n   * @private\n   */\n  normalizeParams(configurations) {\n    configurations.forEach((params) => {\n      Object.keys(params).forEach((key) => {\n        let value = params[key];\n\n        if (value.length > 1) {\n          throw new Error(`Parameter \"${key}\" must have only a single value`);\n        }\n\n        value = value[0];\n\n        if (key === 'client_max_window_bits') {\n          if (value !== true) {\n            const num = +value;\n            if (!Number.isInteger(num) || num < 8 || num > 15) {\n              throw new TypeError(\n                `Invalid value for parameter \"${key}\": ${value}`\n              );\n            }\n            value = num;\n          } else if (!this._isServer) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else if (key === 'server_max_window_bits') {\n          const num = +value;\n          if (!Number.isInteger(num) || num < 8 || num > 15) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n          value = num;\n        } else if (\n          key === 'client_no_context_takeover' ||\n          key === 'server_no_context_takeover'\n        ) {\n          if (value !== true) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else {\n          throw new Error(`Unknown parameter \"${key}\"`);\n        }\n\n        params[key] = value;\n      });\n    });\n\n    return configurations;\n  }\n\n  /**\n   * Decompress data. Concurrency limited.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  decompress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._decompress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Compress data. Concurrency limited.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  compress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._compress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Decompress data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _decompress(data, fin, callback) {\n    const endpoint = this._isServer ? 'client' : 'server';\n\n    if (!this._inflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._inflate = zlib.createInflateRaw({\n        ...this._options.zlibInflateOptions,\n        windowBits\n      });\n      this._inflate[kPerMessageDeflate] = this;\n      this._inflate[kTotalLength] = 0;\n      this._inflate[kBuffers] = [];\n      this._inflate.on('error', inflateOnError);\n      this._inflate.on('data', inflateOnData);\n    }\n\n    this._inflate[kCallback] = callback;\n\n    this._inflate.write(data);\n    if (fin) this._inflate.write(TRAILER);\n\n    this._inflate.flush(() => {\n      const err = this._inflate[kError];\n\n      if (err) {\n        this._inflate.close();\n        this._inflate = null;\n        callback(err);\n        return;\n      }\n\n      const data = bufferUtil.concat(\n        this._inflate[kBuffers],\n        this._inflate[kTotalLength]\n      );\n\n      if (this._inflate._readableState.endEmitted) {\n        this._inflate.close();\n        this._inflate = null;\n      } else {\n        this._inflate[kTotalLength] = 0;\n        this._inflate[kBuffers] = [];\n\n        if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n          this._inflate.reset();\n        }\n      }\n\n      callback(null, data);\n    });\n  }\n\n  /**\n   * Compress data.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _compress(data, fin, callback) {\n    const endpoint = this._isServer ? 'server' : 'client';\n\n    if (!this._deflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._deflate = zlib.createDeflateRaw({\n        ...this._options.zlibDeflateOptions,\n        windowBits\n      });\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      this._deflate.on('data', deflateOnData);\n    }\n\n    this._deflate[kCallback] = callback;\n\n    this._deflate.write(data);\n    this._deflate.flush(zlib.Z_SYNC_FLUSH, () => {\n      if (!this._deflate) {\n        //\n        // The deflate stream was closed while data was being processed.\n        //\n        return;\n      }\n\n      let data = bufferUtil.concat(\n        this._deflate[kBuffers],\n        this._deflate[kTotalLength]\n      );\n\n      if (fin) {\n        data = new FastBuffer(data.buffer, data.byteOffset, data.length - 4);\n      }\n\n      //\n      // Ensure that the callback will not be called again in\n      // `PerMessageDeflate#cleanup()`.\n      //\n      this._deflate[kCallback] = null;\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n        this._deflate.reset();\n      }\n\n      callback(null, data);\n    });\n  }\n}\n\nmodule.exports = PerMessageDeflate;\n\n/**\n * The listener of the `zlib.DeflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction deflateOnData(chunk) {\n  this[kBuffers].push(chunk);\n  this[kTotalLength] += chunk.length;\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction inflateOnData(chunk) {\n  this[kTotalLength] += chunk.length;\n\n  if (\n    this[kPerMessageDeflate]._maxPayload < 1 ||\n    this[kTotalLength] <= this[kPerMessageDeflate]._maxPayload\n  ) {\n    this[kBuffers].push(chunk);\n    return;\n  }\n\n  this[kError] = new RangeError('Max payload size exceeded');\n  this[kError].code = 'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH';\n  this[kError][kStatusCode] = 1009;\n  this.removeListener('data', inflateOnData);\n  this.reset();\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'error'` event.\n *\n * @param {Error} err The emitted error\n * @private\n */\nfunction inflateOnError(err) {\n  //\n  // There is no need to call `Zlib#close()` as the handle is automatically\n  // closed when an error is emitted.\n  //\n  this[kPerMessageDeflate]._inflate = null;\n  err[kStatusCode] = 1007;\n  this[kCallback](err);\n}\n","'use strict';\n\nconst { Writable } = require('stream');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  kStatusCode,\n  kWebSocket\n} = require('./constants');\nconst { concat, toArrayBuffer, unmask } = require('./buffer-util');\nconst { isValidStatusCode, isValidUTF8 } = require('./validation');\n\nconst FastBuffer = Buffer[Symbol.species];\n\nconst GET_INFO = 0;\nconst GET_PAYLOAD_LENGTH_16 = 1;\nconst GET_PAYLOAD_LENGTH_64 = 2;\nconst GET_MASK = 3;\nconst GET_DATA = 4;\nconst INFLATING = 5;\nconst DEFER_EVENT = 6;\n\n/**\n * HyBi Receiver implementation.\n *\n * @extends Writable\n */\nclass Receiver extends Writable {\n  /**\n   * Creates a Receiver instance.\n   *\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {String} [options.binaryType=nodebuffer] The type for binary data\n   * @param {Object} [options.extensions] An object containing the negotiated\n   *     extensions\n   * @param {Boolean} [options.isServer=false] Specifies whether to operate in\n   *     client or server mode\n   * @param {Number} [options.maxPayload=0] The maximum allowed message length\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   */\n  constructor(options = {}) {\n    super();\n\n    this._allowSynchronousEvents =\n      options.allowSynchronousEvents !== undefined\n        ? options.allowSynchronousEvents\n        : true;\n    this._binaryType = options.binaryType || BINARY_TYPES[0];\n    this._extensions = options.extensions || {};\n    this._isServer = !!options.isServer;\n    this._maxPayload = options.maxPayload | 0;\n    this._skipUTF8Validation = !!options.skipUTF8Validation;\n    this[kWebSocket] = undefined;\n\n    this._bufferedBytes = 0;\n    this._buffers = [];\n\n    this._compressed = false;\n    this._payloadLength = 0;\n    this._mask = undefined;\n    this._fragmented = 0;\n    this._masked = false;\n    this._fin = false;\n    this._opcode = 0;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragments = [];\n\n    this._errored = false;\n    this._loop = false;\n    this._state = GET_INFO;\n  }\n\n  /**\n   * Implements `Writable.prototype._write()`.\n   *\n   * @param {Buffer} chunk The chunk of data to write\n   * @param {String} encoding The character encoding of `chunk`\n   * @param {Function} cb Callback\n   * @private\n   */\n  _write(chunk, encoding, cb) {\n    if (this._opcode === 0x08 && this._state == GET_INFO) return cb();\n\n    this._bufferedBytes += chunk.length;\n    this._buffers.push(chunk);\n    this.startLoop(cb);\n  }\n\n  /**\n   * Consumes `n` bytes from the buffered data.\n   *\n   * @param {Number} n The number of bytes to consume\n   * @return {Buffer} The consumed bytes\n   * @private\n   */\n  consume(n) {\n    this._bufferedBytes -= n;\n\n    if (n === this._buffers[0].length) return this._buffers.shift();\n\n    if (n < this._buffers[0].length) {\n      const buf = this._buffers[0];\n      this._buffers[0] = new FastBuffer(\n        buf.buffer,\n        buf.byteOffset + n,\n        buf.length - n\n      );\n\n      return new FastBuffer(buf.buffer, buf.byteOffset, n);\n    }\n\n    const dst = Buffer.allocUnsafe(n);\n\n    do {\n      const buf = this._buffers[0];\n      const offset = dst.length - n;\n\n      if (n >= buf.length) {\n        dst.set(this._buffers.shift(), offset);\n      } else {\n        dst.set(new Uint8Array(buf.buffer, buf.byteOffset, n), offset);\n        this._buffers[0] = new FastBuffer(\n          buf.buffer,\n          buf.byteOffset + n,\n          buf.length - n\n        );\n      }\n\n      n -= buf.length;\n    } while (n > 0);\n\n    return dst;\n  }\n\n  /**\n   * Starts the parsing loop.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  startLoop(cb) {\n    this._loop = true;\n\n    do {\n      switch (this._state) {\n        case GET_INFO:\n          this.getInfo(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_16:\n          this.getPayloadLength16(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_64:\n          this.getPayloadLength64(cb);\n          break;\n        case GET_MASK:\n          this.getMask();\n          break;\n        case GET_DATA:\n          this.getData(cb);\n          break;\n        case INFLATING:\n        case DEFER_EVENT:\n          this._loop = false;\n          return;\n      }\n    } while (this._loop);\n\n    if (!this._errored) cb();\n  }\n\n  /**\n   * Reads the first two bytes of a frame.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getInfo(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(2);\n\n    if ((buf[0] & 0x30) !== 0x00) {\n      const error = this.createError(\n        RangeError,\n        'RSV2 and RSV3 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_2_3'\n      );\n\n      cb(error);\n      return;\n    }\n\n    const compressed = (buf[0] & 0x40) === 0x40;\n\n    if (compressed && !this._extensions[PerMessageDeflate.extensionName]) {\n      const error = this.createError(\n        RangeError,\n        'RSV1 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_1'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._fin = (buf[0] & 0x80) === 0x80;\n    this._opcode = buf[0] & 0x0f;\n    this._payloadLength = buf[1] & 0x7f;\n\n    if (this._opcode === 0x00) {\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (!this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          'invalid opcode 0',\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._opcode = this._fragmented;\n    } else if (this._opcode === 0x01 || this._opcode === 0x02) {\n      if (this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          `invalid opcode ${this._opcode}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._compressed = compressed;\n    } else if (this._opcode > 0x07 && this._opcode < 0x0b) {\n      if (!this._fin) {\n        const error = this.createError(\n          RangeError,\n          'FIN must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_FIN'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (\n        this._payloadLength > 0x7d ||\n        (this._opcode === 0x08 && this._payloadLength === 1)\n      ) {\n        const error = this.createError(\n          RangeError,\n          `invalid payload length ${this._payloadLength}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    } else {\n      const error = this.createError(\n        RangeError,\n        `invalid opcode ${this._opcode}`,\n        true,\n        1002,\n        'WS_ERR_INVALID_OPCODE'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (!this._fin && !this._fragmented) this._fragmented = this._opcode;\n    this._masked = (buf[1] & 0x80) === 0x80;\n\n    if (this._isServer) {\n      if (!this._masked) {\n        const error = this.createError(\n          RangeError,\n          'MASK must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_MASK'\n        );\n\n        cb(error);\n        return;\n      }\n    } else if (this._masked) {\n      const error = this.createError(\n        RangeError,\n        'MASK must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_MASK'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (this._payloadLength === 126) this._state = GET_PAYLOAD_LENGTH_16;\n    else if (this._payloadLength === 127) this._state = GET_PAYLOAD_LENGTH_64;\n    else this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+16).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength16(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    this._payloadLength = this.consume(2).readUInt16BE(0);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+64).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength64(cb) {\n    if (this._bufferedBytes < 8) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(8);\n    const num = buf.readUInt32BE(0);\n\n    //\n    // The maximum safe integer in JavaScript is 2^53 - 1. An error is returned\n    // if payload length is greater than this number.\n    //\n    if (num > Math.pow(2, 53 - 32) - 1) {\n      const error = this.createError(\n        RangeError,\n        'Unsupported WebSocket frame: payload length > 2^53 - 1',\n        false,\n        1009,\n        'WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._payloadLength = num * Math.pow(2, 32) + buf.readUInt32BE(4);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Payload length has been read.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  haveLength(cb) {\n    if (this._payloadLength && this._opcode < 0x08) {\n      this._totalPayloadLength += this._payloadLength;\n      if (this._totalPayloadLength > this._maxPayload && this._maxPayload > 0) {\n        const error = this.createError(\n          RangeError,\n          'Max payload size exceeded',\n          false,\n          1009,\n          'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    }\n\n    if (this._masked) this._state = GET_MASK;\n    else this._state = GET_DATA;\n  }\n\n  /**\n   * Reads mask bytes.\n   *\n   * @private\n   */\n  getMask() {\n    if (this._bufferedBytes < 4) {\n      this._loop = false;\n      return;\n    }\n\n    this._mask = this.consume(4);\n    this._state = GET_DATA;\n  }\n\n  /**\n   * Reads data bytes.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getData(cb) {\n    let data = EMPTY_BUFFER;\n\n    if (this._payloadLength) {\n      if (this._bufferedBytes < this._payloadLength) {\n        this._loop = false;\n        return;\n      }\n\n      data = this.consume(this._payloadLength);\n\n      if (\n        this._masked &&\n        (this._mask[0] | this._mask[1] | this._mask[2] | this._mask[3]) !== 0\n      ) {\n        unmask(data, this._mask);\n      }\n    }\n\n    if (this._opcode > 0x07) {\n      this.controlMessage(data, cb);\n      return;\n    }\n\n    if (this._compressed) {\n      this._state = INFLATING;\n      this.decompress(data, cb);\n      return;\n    }\n\n    if (data.length) {\n      //\n      // This message is not compressed so its length is the sum of the payload\n      // length of all fragments.\n      //\n      this._messageLength = this._totalPayloadLength;\n      this._fragments.push(data);\n    }\n\n    this.dataMessage(cb);\n  }\n\n  /**\n   * Decompresses data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Function} cb Callback\n   * @private\n   */\n  decompress(data, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    perMessageDeflate.decompress(data, this._fin, (err, buf) => {\n      if (err) return cb(err);\n\n      if (buf.length) {\n        this._messageLength += buf.length;\n        if (this._messageLength > this._maxPayload && this._maxPayload > 0) {\n          const error = this.createError(\n            RangeError,\n            'Max payload size exceeded',\n            false,\n            1009,\n            'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._fragments.push(buf);\n      }\n\n      this.dataMessage(cb);\n      if (this._state === GET_INFO) this.startLoop(cb);\n    });\n  }\n\n  /**\n   * Handles a data message.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  dataMessage(cb) {\n    if (!this._fin) {\n      this._state = GET_INFO;\n      return;\n    }\n\n    const messageLength = this._messageLength;\n    const fragments = this._fragments;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragmented = 0;\n    this._fragments = [];\n\n    if (this._opcode === 2) {\n      let data;\n\n      if (this._binaryType === 'nodebuffer') {\n        data = concat(fragments, messageLength);\n      } else if (this._binaryType === 'arraybuffer') {\n        data = toArrayBuffer(concat(fragments, messageLength));\n      } else if (this._binaryType === 'blob') {\n        data = new Blob(fragments);\n      } else {\n        data = fragments;\n      }\n\n      if (this._allowSynchronousEvents) {\n        this.emit('message', data, true);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', data, true);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    } else {\n      const buf = concat(fragments, messageLength);\n\n      if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n        const error = this.createError(\n          Error,\n          'invalid UTF-8 sequence',\n          true,\n          1007,\n          'WS_ERR_INVALID_UTF8'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (this._state === INFLATING || this._allowSynchronousEvents) {\n        this.emit('message', buf, false);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', buf, false);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    }\n  }\n\n  /**\n   * Handles a control message.\n   *\n   * @param {Buffer} data Data to handle\n   * @return {(Error|RangeError|undefined)} A possible error\n   * @private\n   */\n  controlMessage(data, cb) {\n    if (this._opcode === 0x08) {\n      if (data.length === 0) {\n        this._loop = false;\n        this.emit('conclude', 1005, EMPTY_BUFFER);\n        this.end();\n      } else {\n        const code = data.readUInt16BE(0);\n\n        if (!isValidStatusCode(code)) {\n          const error = this.createError(\n            RangeError,\n            `invalid status code ${code}`,\n            true,\n            1002,\n            'WS_ERR_INVALID_CLOSE_CODE'\n          );\n\n          cb(error);\n          return;\n        }\n\n        const buf = new FastBuffer(\n          data.buffer,\n          data.byteOffset + 2,\n          data.length - 2\n        );\n\n        if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n          const error = this.createError(\n            Error,\n            'invalid UTF-8 sequence',\n            true,\n            1007,\n            'WS_ERR_INVALID_UTF8'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._loop = false;\n        this.emit('conclude', code, buf);\n        this.end();\n      }\n\n      this._state = GET_INFO;\n      return;\n    }\n\n    if (this._allowSynchronousEvents) {\n      this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n      this._state = GET_INFO;\n    } else {\n      this._state = DEFER_EVENT;\n      setImmediate(() => {\n        this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n        this._state = GET_INFO;\n        this.startLoop(cb);\n      });\n    }\n  }\n\n  /**\n   * Builds an error object.\n   *\n   * @param {function(new:Error|RangeError)} ErrorCtor The error constructor\n   * @param {String} message The error message\n   * @param {Boolean} prefix Specifies whether or not to add a default prefix to\n   *     `message`\n   * @param {Number} statusCode The status code\n   * @param {String} errorCode The exposed error code\n   * @return {(Error|RangeError)} The error\n   * @private\n   */\n  createError(ErrorCtor, message, prefix, statusCode, errorCode) {\n    this._loop = false;\n    this._errored = true;\n\n    const err = new ErrorCtor(\n      prefix ? `Invalid WebSocket frame: ${message}` : message\n    );\n\n    Error.captureStackTrace(err, this.createError);\n    err.code = errorCode;\n    err[kStatusCode] = statusCode;\n    return err;\n  }\n}\n\nmodule.exports = Receiver;\n","'use strict';\n\ntry {\n  module.exports = require('node-gyp-build')(__dirname);\n} catch (e) {\n  module.exports = require('./fallback');\n}\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Adds an offer to the map of extension offers or a parameter to the map of\n * parameters.\n *\n * @param {Object} dest The map of extension offers or parameters\n * @param {String} name The extension or parameter name\n * @param {(Object|Boolean|String)} elem The extension parameters or the\n *     parameter value\n * @private\n */\nfunction push(dest, name, elem) {\n  if (dest[name] === undefined) dest[name] = [elem];\n  else dest[name].push(elem);\n}\n\n/**\n * Parses the `Sec-WebSocket-Extensions` header into an object.\n *\n * @param {String} header The field value of the header\n * @return {Object} The parsed object\n * @public\n */\nfunction parse(header) {\n  const offers = Object.create(null);\n  let params = Object.create(null);\n  let mustUnescape = false;\n  let isEscaping = false;\n  let inQuotes = false;\n  let extensionName;\n  let paramName;\n  let start = -1;\n  let code = -1;\n  let end = -1;\n  let i = 0;\n\n  for (; i < header.length; i++) {\n    code = header.charCodeAt(i);\n\n    if (extensionName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (\n        i !== 0 &&\n        (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n      ) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b /* ';' */ || code === 0x2c /* ',' */) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        const name = header.slice(start, end);\n        if (code === 0x2c) {\n          push(offers, name, params);\n          params = Object.create(null);\n        } else {\n          extensionName = name;\n        }\n\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else if (paramName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (code === 0x20 || code === 0x09) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        push(params, header.slice(start, end), true);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        start = end = -1;\n      } else if (code === 0x3d /* '=' */ && start !== -1 && end === -1) {\n        paramName = header.slice(start, i);\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else {\n      //\n      // The value of a quoted-string after unescaping must conform to the\n      // token ABNF, so only token characters are valid.\n      // Ref: https://tools.ietf.org/html/rfc6455#section-9.1\n      //\n      if (isEscaping) {\n        if (tokenChars[code] !== 1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n        if (start === -1) start = i;\n        else if (!mustUnescape) mustUnescape = true;\n        isEscaping = false;\n      } else if (inQuotes) {\n        if (tokenChars[code] === 1) {\n          if (start === -1) start = i;\n        } else if (code === 0x22 /* '\"' */ && start !== -1) {\n          inQuotes = false;\n          end = i;\n        } else if (code === 0x5c /* '\\' */) {\n          isEscaping = true;\n        } else {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n      } else if (code === 0x22 && header.charCodeAt(i - 1) === 0x3d) {\n        inQuotes = true;\n      } else if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (start !== -1 && (code === 0x20 || code === 0x09)) {\n        if (end === -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        let value = header.slice(start, end);\n        if (mustUnescape) {\n          value = value.replace(/\\\\/g, '');\n          mustUnescape = false;\n        }\n        push(params, paramName, value);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        paramName = undefined;\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    }\n  }\n\n  if (start === -1 || inQuotes || code === 0x20 || code === 0x09) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  if (end === -1) end = i;\n  const token = header.slice(start, end);\n  if (extensionName === undefined) {\n    push(offers, token, params);\n  } else {\n    if (paramName === undefined) {\n      push(params, token, true);\n    } else if (mustUnescape) {\n      push(params, paramName, token.replace(/\\\\/g, ''));\n    } else {\n      push(params, paramName, token);\n    }\n    push(offers, extensionName, params);\n  }\n\n  return offers;\n}\n\n/**\n * Builds the `Sec-WebSocket-Extensions` header field value.\n *\n * @param {Object} extensions The map of extensions and parameters to format\n * @return {String} A string representing the given object\n * @public\n */\nfunction format(extensions) {\n  return Object.keys(extensions)\n    .map((extension) => {\n      let configurations = extensions[extension];\n      if (!Array.isArray(configurations)) configurations = [configurations];\n      return configurations\n        .map((params) => {\n          return [extension]\n            .concat(\n              Object.keys(params).map((k) => {\n                let values = params[k];\n                if (!Array.isArray(values)) values = [values];\n                return values\n                  .map((v) => (v === true ? k : `${k}=${v}`))\n                  .join('; ');\n              })\n            )\n            .join('; ');\n        })\n        .join(', ');\n    })\n    .join(', ');\n}\n\nmodule.exports = { format, parse };\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst http = require('http');\nconst { Duplex } = require('stream');\nconst { createHash } = require('crypto');\n\nconst extension = require('./extension');\nconst PerMessageDeflate = require('./permessage-deflate');\nconst subprotocol = require('./subprotocol');\nconst WebSocket = require('./websocket');\nconst { GUID, kWebSocket } = require('./constants');\n\nconst keyRegex = /^[+/0-9A-Za-z]{22}==$/;\n\nconst RUNNING = 0;\nconst CLOSING = 1;\nconst CLOSED = 2;\n\n/**\n * Class representing a WebSocket server.\n *\n * @extends EventEmitter\n */\nclass WebSocketServer extends EventEmitter {\n  /**\n   * Create a `WebSocketServer` instance.\n   *\n   * @param {Object} options Configuration options\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n   *     automatically send a pong in response to a ping\n   * @param {Number} [options.backlog=511] The maximum length of the queue of\n   *     pending connections\n   * @param {Boolean} [options.clientTracking=true] Specifies whether or not to\n   *     track clients\n   * @param {Function} [options.handleProtocols] A hook to handle protocols\n   * @param {String} [options.host] The hostname where to bind the server\n   * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n   *     size\n   * @param {Boolean} [options.noServer=false] Enable no server mode\n   * @param {String} [options.path] Accept only connections matching this path\n   * @param {(Boolean|Object)} [options.perMessageDeflate=false] Enable/disable\n   *     permessage-deflate\n   * @param {Number} [options.port] The port where to bind the server\n   * @param {(http.Server|https.Server)} [options.server] A pre-created HTTP/S\n   *     server to use\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @param {Function} [options.verifyClient] A hook to reject connections\n   * @param {Function} [options.WebSocket=WebSocket] Specifies the `WebSocket`\n   *     class to use. It must be the `WebSocket` class or class that extends it\n   * @param {Function} [callback] A listener for the `listening` event\n   */\n  constructor(options, callback) {\n    super();\n\n    options = {\n      allowSynchronousEvents: true,\n      autoPong: true,\n      maxPayload: 100 * 1024 * 1024,\n      skipUTF8Validation: false,\n      perMessageDeflate: false,\n      handleProtocols: null,\n      clientTracking: true,\n      verifyClient: null,\n      noServer: false,\n      backlog: null, // use default (511 as implemented in net.js)\n      server: null,\n      host: null,\n      path: null,\n      port: null,\n      WebSocket,\n      ...options\n    };\n\n    if (\n      (options.port == null && !options.server && !options.noServer) ||\n      (options.port != null && (options.server || options.noServer)) ||\n      (options.server && options.noServer)\n    ) {\n      throw new TypeError(\n        'One and only one of the \"port\", \"server\", or \"noServer\" options ' +\n          'must be specified'\n      );\n    }\n\n    if (options.port != null) {\n      this._server = http.createServer((req, res) => {\n        const body = http.STATUS_CODES[426];\n\n        res.writeHead(426, {\n          'Content-Length': body.length,\n          'Content-Type': 'text/plain'\n        });\n        res.end(body);\n      });\n      this._server.listen(\n        options.port,\n        options.host,\n        options.backlog,\n        callback\n      );\n    } else if (options.server) {\n      this._server = options.server;\n    }\n\n    if (this._server) {\n      const emitConnection = this.emit.bind(this, 'connection');\n\n      this._removeListeners = addListeners(this._server, {\n        listening: this.emit.bind(this, 'listening'),\n        error: this.emit.bind(this, 'error'),\n        upgrade: (req, socket, head) => {\n          this.handleUpgrade(req, socket, head, emitConnection);\n        }\n      });\n    }\n\n    if (options.perMessageDeflate === true) options.perMessageDeflate = {};\n    if (options.clientTracking) {\n      this.clients = new Set();\n      this._shouldEmitClose = false;\n    }\n\n    this.options = options;\n    this._state = RUNNING;\n  }\n\n  /**\n   * Returns the bound address, the address family name, and port of the server\n   * as reported by the operating system if listening on an IP socket.\n   * If the server is listening on a pipe or UNIX domain socket, the name is\n   * returned as a string.\n   *\n   * @return {(Object|String|null)} The address of the server\n   * @public\n   */\n  address() {\n    if (this.options.noServer) {\n      throw new Error('The server is operating in \"noServer\" mode');\n    }\n\n    if (!this._server) return null;\n    return this._server.address();\n  }\n\n  /**\n   * Stop the server from accepting new connections and emit the `'close'` event\n   * when all existing connections are closed.\n   *\n   * @param {Function} [cb] A one-time listener for the `'close'` event\n   * @public\n   */\n  close(cb) {\n    if (this._state === CLOSED) {\n      if (cb) {\n        this.once('close', () => {\n          cb(new Error('The server is not running'));\n        });\n      }\n\n      process.nextTick(emitClose, this);\n      return;\n    }\n\n    if (cb) this.once('close', cb);\n\n    if (this._state === CLOSING) return;\n    this._state = CLOSING;\n\n    if (this.options.noServer || this.options.server) {\n      if (this._server) {\n        this._removeListeners();\n        this._removeListeners = this._server = null;\n      }\n\n      if (this.clients) {\n        if (!this.clients.size) {\n          process.nextTick(emitClose, this);\n        } else {\n          this._shouldEmitClose = true;\n        }\n      } else {\n        process.nextTick(emitClose, this);\n      }\n    } else {\n      const server = this._server;\n\n      this._removeListeners();\n      this._removeListeners = this._server = null;\n\n      //\n      // The HTTP/S server was created internally. Close it, and rely on its\n      // `'close'` event.\n      //\n      server.close(() => {\n        emitClose(this);\n      });\n    }\n  }\n\n  /**\n   * See if a given request should be handled by this server instance.\n   *\n   * @param {http.IncomingMessage} req Request object to inspect\n   * @return {Boolean} `true` if the request is valid, else `false`\n   * @public\n   */\n  shouldHandle(req) {\n    if (this.options.path) {\n      const index = req.url.indexOf('?');\n      const pathname = index !== -1 ? req.url.slice(0, index) : req.url;\n\n      if (pathname !== this.options.path) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Handle a HTTP Upgrade request.\n   *\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @public\n   */\n  handleUpgrade(req, socket, head, cb) {\n    socket.on('error', socketOnError);\n\n    const key = req.headers['sec-websocket-key'];\n    const upgrade = req.headers.upgrade;\n    const version = +req.headers['sec-websocket-version'];\n\n    if (req.method !== 'GET') {\n      const message = 'Invalid HTTP method';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 405, message);\n      return;\n    }\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      const message = 'Invalid Upgrade header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (key === undefined || !keyRegex.test(key)) {\n      const message = 'Missing or invalid Sec-WebSocket-Key header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (version !== 8 && version !== 13) {\n      const message = 'Missing or invalid Sec-WebSocket-Version header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (!this.shouldHandle(req)) {\n      abortHandshake(socket, 400);\n      return;\n    }\n\n    const secWebSocketProtocol = req.headers['sec-websocket-protocol'];\n    let protocols = new Set();\n\n    if (secWebSocketProtocol !== undefined) {\n      try {\n        protocols = subprotocol.parse(secWebSocketProtocol);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Protocol header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    const secWebSocketExtensions = req.headers['sec-websocket-extensions'];\n    const extensions = {};\n\n    if (\n      this.options.perMessageDeflate &&\n      secWebSocketExtensions !== undefined\n    ) {\n      const perMessageDeflate = new PerMessageDeflate(\n        this.options.perMessageDeflate,\n        true,\n        this.options.maxPayload\n      );\n\n      try {\n        const offers = extension.parse(secWebSocketExtensions);\n\n        if (offers[PerMessageDeflate.extensionName]) {\n          perMessageDeflate.accept(offers[PerMessageDeflate.extensionName]);\n          extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n        }\n      } catch (err) {\n        const message =\n          'Invalid or unacceptable Sec-WebSocket-Extensions header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    //\n    // Optionally call external client verification handler.\n    //\n    if (this.options.verifyClient) {\n      const info = {\n        origin:\n          req.headers[`${version === 8 ? 'sec-websocket-origin' : 'origin'}`],\n        secure: !!(req.socket.authorized || req.socket.encrypted),\n        req\n      };\n\n      if (this.options.verifyClient.length === 2) {\n        this.options.verifyClient(info, (verified, code, message, headers) => {\n          if (!verified) {\n            return abortHandshake(socket, code || 401, message, headers);\n          }\n\n          this.completeUpgrade(\n            extensions,\n            key,\n            protocols,\n            req,\n            socket,\n            head,\n            cb\n          );\n        });\n        return;\n      }\n\n      if (!this.options.verifyClient(info)) return abortHandshake(socket, 401);\n    }\n\n    this.completeUpgrade(extensions, key, protocols, req, socket, head, cb);\n  }\n\n  /**\n   * Upgrade the connection to WebSocket.\n   *\n   * @param {Object} extensions The accepted extensions\n   * @param {String} key The value of the `Sec-WebSocket-Key` header\n   * @param {Set} protocols The subprotocols\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @throws {Error} If called more than once with the same socket\n   * @private\n   */\n  completeUpgrade(extensions, key, protocols, req, socket, head, cb) {\n    //\n    // Destroy the socket if the client has already sent a FIN packet.\n    //\n    if (!socket.readable || !socket.writable) return socket.destroy();\n\n    if (socket[kWebSocket]) {\n      throw new Error(\n        'server.handleUpgrade() was called more than once with the same ' +\n          'socket, possibly due to a misconfiguration'\n      );\n    }\n\n    if (this._state > RUNNING) return abortHandshake(socket, 503);\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    const headers = [\n      'HTTP/1.1 101 Switching Protocols',\n      'Upgrade: websocket',\n      'Connection: Upgrade',\n      `Sec-WebSocket-Accept: ${digest}`\n    ];\n\n    const ws = new this.options.WebSocket(null, undefined, this.options);\n\n    if (protocols.size) {\n      //\n      // Optionally call external protocol selection handler.\n      //\n      const protocol = this.options.handleProtocols\n        ? this.options.handleProtocols(protocols, req)\n        : protocols.values().next().value;\n\n      if (protocol) {\n        headers.push(`Sec-WebSocket-Protocol: ${protocol}`);\n        ws._protocol = protocol;\n      }\n    }\n\n    if (extensions[PerMessageDeflate.extensionName]) {\n      const params = extensions[PerMessageDeflate.extensionName].params;\n      const value = extension.format({\n        [PerMessageDeflate.extensionName]: [params]\n      });\n      headers.push(`Sec-WebSocket-Extensions: ${value}`);\n      ws._extensions = extensions;\n    }\n\n    //\n    // Allow external modification/inspection of handshake headers.\n    //\n    this.emit('headers', headers, req);\n\n    socket.write(headers.concat('\\r\\n').join('\\r\\n'));\n    socket.removeListener('error', socketOnError);\n\n    ws.setSocket(socket, head, {\n      allowSynchronousEvents: this.options.allowSynchronousEvents,\n      maxPayload: this.options.maxPayload,\n      skipUTF8Validation: this.options.skipUTF8Validation\n    });\n\n    if (this.clients) {\n      this.clients.add(ws);\n      ws.on('close', () => {\n        this.clients.delete(ws);\n\n        if (this._shouldEmitClose && !this.clients.size) {\n          process.nextTick(emitClose, this);\n        }\n      });\n    }\n\n    cb(ws, req);\n  }\n}\n\nmodule.exports = WebSocketServer;\n\n/**\n * Add event listeners on an `EventEmitter` using a map of <event, listener>\n * pairs.\n *\n * @param {EventEmitter} server The event emitter\n * @param {Object.<String, Function>} map The listeners to add\n * @return {Function} A function that will remove the added listeners when\n *     called\n * @private\n */\nfunction addListeners(server, map) {\n  for (const event of Object.keys(map)) server.on(event, map[event]);\n\n  return function removeListeners() {\n    for (const event of Object.keys(map)) {\n      server.removeListener(event, map[event]);\n    }\n  };\n}\n\n/**\n * Emit a `'close'` event on an `EventEmitter`.\n *\n * @param {EventEmitter} server The event emitter\n * @private\n */\nfunction emitClose(server) {\n  server._state = CLOSED;\n  server.emit('close');\n}\n\n/**\n * Handle socket errors.\n *\n * @private\n */\nfunction socketOnError() {\n  this.destroy();\n}\n\n/**\n * Close the connection when preconditions are not fulfilled.\n *\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} [message] The HTTP response body\n * @param {Object} [headers] Additional HTTP response headers\n * @private\n */\nfunction abortHandshake(socket, code, message, headers) {\n  //\n  // The socket is writable unless the user destroyed or ended it before calling\n  // `server.handleUpgrade()` or in the `verifyClient` function, which is a user\n  // error. Handling this does not make much sense as the worst that can happen\n  // is that some of the data written by the user might be discarded due to the\n  // call to `socket.end()` below, which triggers an `'error'` event that in\n  // turn causes the socket to be destroyed.\n  //\n  message = message || http.STATUS_CODES[code];\n  headers = {\n    Connection: 'close',\n    'Content-Type': 'text/html',\n    'Content-Length': Buffer.byteLength(message),\n    ...headers\n  };\n\n  socket.once('finish', socket.destroy);\n\n  socket.end(\n    `HTTP/1.1 ${code} ${http.STATUS_CODES[code]}\\r\\n` +\n      Object.keys(headers)\n        .map((h) => `${h}: ${headers[h]}`)\n        .join('\\r\\n') +\n      '\\r\\n\\r\\n' +\n      message\n  );\n}\n\n/**\n * Emit a `'wsClientError'` event on a `WebSocketServer` if there is at least\n * one listener for it, otherwise call `abortHandshake()`.\n *\n * @param {WebSocketServer} server The WebSocket server\n * @param {http.IncomingMessage} req The request object\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} message The HTTP response body\n * @private\n */\nfunction abortHandshakeOrEmitwsClientError(server, req, socket, code, message) {\n  if (server.listenerCount('wsClientError')) {\n    const err = new Error(message);\n    Error.captureStackTrace(err, abortHandshakeOrEmitwsClientError);\n\n    server.emit('wsClientError', err, socket, req);\n  } else {\n    abortHandshake(socket, code, message);\n  }\n}\n","'use strict';\n\n/**\n * Masks a buffer using the given mask.\n *\n * @param {Buffer} source The buffer to mask\n * @param {Buffer} mask The mask to use\n * @param {Buffer} output The buffer where to store the result\n * @param {Number} offset The offset at which to start writing\n * @param {Number} length The number of bytes to mask.\n * @public\n */\nconst mask = (source, mask, output, offset, length) => {\n  for (var i = 0; i < length; i++) {\n    output[offset + i] = source[i] ^ mask[i & 3];\n  }\n};\n\n/**\n * Unmasks a buffer using the given mask.\n *\n * @param {Buffer} buffer The buffer to unmask\n * @param {Buffer} mask The mask to use\n * @public\n */\nconst unmask = (buffer, mask) => {\n  // Required until https://github.com/nodejs/node/issues/9006 is resolved.\n  const length = buffer.length;\n  for (var i = 0; i < length; i++) {\n    buffer[i] ^= mask[i & 3];\n  }\n};\n\nmodule.exports = { mask, unmask };\n","const runtimeRequire = typeof __webpack_require__ === 'function' ? __non_webpack_require__ : require // eslint-disable-line\nif (typeof runtimeRequire.addon === 'function') { // if the platform supports native resolving prefer that\n  module.exports = runtimeRequire.addon.bind(runtimeRequire)\n} else { // else use the runtime version here\n  module.exports = require('./node-gyp-build.js')\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex\" }] */\n\n'use strict';\n\nconst { Duplex } = require('stream');\nconst { randomFillSync } = require('crypto');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst { EMPTY_BUFFER, kWebSocket, NOOP } = require('./constants');\nconst { isBlob, isValidStatusCode } = require('./validation');\nconst { mask: applyMask, toBuffer } = require('./buffer-util');\n\nconst kByteLength = Symbol('kByteLength');\nconst maskBuffer = Buffer.alloc(4);\nconst RANDOM_POOL_SIZE = 8 * 1024;\nlet randomPool;\nlet randomPoolPointer = RANDOM_POOL_SIZE;\n\nconst DEFAULT = 0;\nconst DEFLATING = 1;\nconst GET_BLOB_DATA = 2;\n\n/**\n * HyBi Sender implementation.\n */\nclass Sender {\n  /**\n   * Creates a Sender instance.\n   *\n   * @param {Duplex} socket The connection socket\n   * @param {Object} [extensions] An object containing the negotiated extensions\n   * @param {Function} [generateMask] The function used to generate the masking\n   *     key\n   */\n  constructor(socket, extensions, generateMask) {\n    this._extensions = extensions || {};\n\n    if (generateMask) {\n      this._generateMask = generateMask;\n      this._maskBuffer = Buffer.alloc(4);\n    }\n\n    this._socket = socket;\n\n    this._firstFragment = true;\n    this._compress = false;\n\n    this._bufferedBytes = 0;\n    this._queue = [];\n    this._state = DEFAULT;\n    this.onerror = NOOP;\n    this[kWebSocket] = undefined;\n  }\n\n  /**\n   * Frames a piece of data according to the HyBi WebSocket protocol.\n   *\n   * @param {(Buffer|String)} data The data to frame\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @return {(Buffer|String)[]} The framed data\n   * @public\n   */\n  static frame(data, options) {\n    let mask;\n    let merge = false;\n    let offset = 2;\n    let skipMasking = false;\n\n    if (options.mask) {\n      mask = options.maskBuffer || maskBuffer;\n\n      if (options.generateMask) {\n        options.generateMask(mask);\n      } else {\n        if (randomPoolPointer === RANDOM_POOL_SIZE) {\n          /* istanbul ignore else  */\n          if (randomPool === undefined) {\n            //\n            // This is lazily initialized because server-sent frames must not\n            // be masked so it may never be used.\n            //\n            randomPool = Buffer.alloc(RANDOM_POOL_SIZE);\n          }\n\n          randomFillSync(randomPool, 0, RANDOM_POOL_SIZE);\n          randomPoolPointer = 0;\n        }\n\n        mask[0] = randomPool[randomPoolPointer++];\n        mask[1] = randomPool[randomPoolPointer++];\n        mask[2] = randomPool[randomPoolPointer++];\n        mask[3] = randomPool[randomPoolPointer++];\n      }\n\n      skipMasking = (mask[0] | mask[1] | mask[2] | mask[3]) === 0;\n      offset = 6;\n    }\n\n    let dataLength;\n\n    if (typeof data === 'string') {\n      if (\n        (!options.mask || skipMasking) &&\n        options[kByteLength] !== undefined\n      ) {\n        dataLength = options[kByteLength];\n      } else {\n        data = Buffer.from(data);\n        dataLength = data.length;\n      }\n    } else {\n      dataLength = data.length;\n      merge = options.mask && options.readOnly && !skipMasking;\n    }\n\n    let payloadLength = dataLength;\n\n    if (dataLength >= 65536) {\n      offset += 8;\n      payloadLength = 127;\n    } else if (dataLength > 125) {\n      offset += 2;\n      payloadLength = 126;\n    }\n\n    const target = Buffer.allocUnsafe(merge ? dataLength + offset : offset);\n\n    target[0] = options.fin ? options.opcode | 0x80 : options.opcode;\n    if (options.rsv1) target[0] |= 0x40;\n\n    target[1] = payloadLength;\n\n    if (payloadLength === 126) {\n      target.writeUInt16BE(dataLength, 2);\n    } else if (payloadLength === 127) {\n      target[2] = target[3] = 0;\n      target.writeUIntBE(dataLength, 4, 6);\n    }\n\n    if (!options.mask) return [target, data];\n\n    target[1] |= 0x80;\n    target[offset - 4] = mask[0];\n    target[offset - 3] = mask[1];\n    target[offset - 2] = mask[2];\n    target[offset - 1] = mask[3];\n\n    if (skipMasking) return [target, data];\n\n    if (merge) {\n      applyMask(data, mask, target, offset, dataLength);\n      return [target];\n    }\n\n    applyMask(data, mask, data, 0, dataLength);\n    return [target, data];\n  }\n\n  /**\n   * Sends a close message to the other peer.\n   *\n   * @param {Number} [code] The status code component of the body\n   * @param {(String|Buffer)} [data] The message component of the body\n   * @param {Boolean} [mask=false] Specifies whether or not to mask the message\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  close(code, data, mask, cb) {\n    let buf;\n\n    if (code === undefined) {\n      buf = EMPTY_BUFFER;\n    } else if (typeof code !== 'number' || !isValidStatusCode(code)) {\n      throw new TypeError('First argument must be a valid error code number');\n    } else if (data === undefined || !data.length) {\n      buf = Buffer.allocUnsafe(2);\n      buf.writeUInt16BE(code, 0);\n    } else {\n      const length = Buffer.byteLength(data);\n\n      if (length > 123) {\n        throw new RangeError('The message must not be greater than 123 bytes');\n      }\n\n      buf = Buffer.allocUnsafe(2 + length);\n      buf.writeUInt16BE(code, 0);\n\n      if (typeof data === 'string') {\n        buf.write(data, 2);\n      } else {\n        buf.set(data, 2);\n      }\n    }\n\n    const options = {\n      [kByteLength]: buf.length,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x08,\n      readOnly: false,\n      rsv1: false\n    };\n\n    if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, buf, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(buf, options), cb);\n    }\n  }\n\n  /**\n   * Sends a ping message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  ping(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x09,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a pong message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  pong(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x0a,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a data message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Object} options Options object\n   * @param {Boolean} [options.binary=false] Specifies whether `data` is binary\n   *     or text\n   * @param {Boolean} [options.compress=false] Specifies whether or not to\n   *     compress `data`\n   * @param {Boolean} [options.fin=false] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  send(data, options, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n    let opcode = options.binary ? 2 : 1;\n    let rsv1 = options.compress;\n\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (this._firstFragment) {\n      this._firstFragment = false;\n      if (\n        rsv1 &&\n        perMessageDeflate &&\n        perMessageDeflate.params[\n          perMessageDeflate._isServer\n            ? 'server_no_context_takeover'\n            : 'client_no_context_takeover'\n        ]\n      ) {\n        rsv1 = byteLength >= perMessageDeflate._threshold;\n      }\n      this._compress = rsv1;\n    } else {\n      rsv1 = false;\n      opcode = 0;\n    }\n\n    if (options.fin) this._firstFragment = true;\n\n    const opts = {\n      [kByteLength]: byteLength,\n      fin: options.fin,\n      generateMask: this._generateMask,\n      mask: options.mask,\n      maskBuffer: this._maskBuffer,\n      opcode,\n      readOnly,\n      rsv1\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, this._compress, opts, cb]);\n      } else {\n        this.getBlobData(data, this._compress, opts, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, this._compress, opts, cb]);\n    } else {\n      this.dispatch(data, this._compress, opts, cb);\n    }\n  }\n\n  /**\n   * Gets the contents of a blob as binary data.\n   *\n   * @param {Blob} blob The blob\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     the data\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  getBlobData(blob, compress, options, cb) {\n    this._bufferedBytes += options[kByteLength];\n    this._state = GET_BLOB_DATA;\n\n    blob\n      .arrayBuffer()\n      .then((arrayBuffer) => {\n        if (this._socket.destroyed) {\n          const err = new Error(\n            'The socket was closed while the blob was being read'\n          );\n\n          //\n          // `callCallbacks` is called in the next tick to ensure that errors\n          // that might be thrown in the callbacks behave like errors thrown\n          // outside the promise chain.\n          //\n          process.nextTick(callCallbacks, this, err, cb);\n          return;\n        }\n\n        this._bufferedBytes -= options[kByteLength];\n        const data = toBuffer(arrayBuffer);\n\n        if (!compress) {\n          this._state = DEFAULT;\n          this.sendFrame(Sender.frame(data, options), cb);\n          this.dequeue();\n        } else {\n          this.dispatch(data, compress, options, cb);\n        }\n      })\n      .catch((err) => {\n        //\n        // `onError` is called in the next tick for the same reason that\n        // `callCallbacks` above is.\n        //\n        process.nextTick(onError, this, err, cb);\n      });\n  }\n\n  /**\n   * Dispatches a message.\n   *\n   * @param {(Buffer|String)} data The message to send\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     `data`\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  dispatch(data, compress, options, cb) {\n    if (!compress) {\n      this.sendFrame(Sender.frame(data, options), cb);\n      return;\n    }\n\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    this._bufferedBytes += options[kByteLength];\n    this._state = DEFLATING;\n    perMessageDeflate.compress(data, options.fin, (_, buf) => {\n      if (this._socket.destroyed) {\n        const err = new Error(\n          'The socket was closed while data was being compressed'\n        );\n\n        callCallbacks(this, err, cb);\n        return;\n      }\n\n      this._bufferedBytes -= options[kByteLength];\n      this._state = DEFAULT;\n      options.readOnly = false;\n      this.sendFrame(Sender.frame(buf, options), cb);\n      this.dequeue();\n    });\n  }\n\n  /**\n   * Executes queued send operations.\n   *\n   * @private\n   */\n  dequeue() {\n    while (this._state === DEFAULT && this._queue.length) {\n      const params = this._queue.shift();\n\n      this._bufferedBytes -= params[3][kByteLength];\n      Reflect.apply(params[0], this, params.slice(1));\n    }\n  }\n\n  /**\n   * Enqueues a send operation.\n   *\n   * @param {Array} params Send operation parameters.\n   * @private\n   */\n  enqueue(params) {\n    this._bufferedBytes += params[3][kByteLength];\n    this._queue.push(params);\n  }\n\n  /**\n   * Sends a frame.\n   *\n   * @param {(Buffer | String)[]} list The frame to send\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  sendFrame(list, cb) {\n    if (list.length === 2) {\n      this._socket.cork();\n      this._socket.write(list[0]);\n      this._socket.write(list[1], cb);\n      this._socket.uncork();\n    } else {\n      this._socket.write(list[0], cb);\n    }\n  }\n}\n\nmodule.exports = Sender;\n\n/**\n * Calls queued callbacks with an error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error to call the callbacks with\n * @param {Function} [cb] The first callback\n * @private\n */\nfunction callCallbacks(sender, err, cb) {\n  if (typeof cb === 'function') cb(err);\n\n  for (let i = 0; i < sender._queue.length; i++) {\n    const params = sender._queue[i];\n    const callback = params[params.length - 1];\n\n    if (typeof callback === 'function') callback(err);\n  }\n}\n\n/**\n * Handles a `Sender` error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error\n * @param {Function} [cb] The first pending callback\n * @private\n */\nfunction onError(sender, err, cb) {\n  callCallbacks(sender, err, cb);\n  sender.onerror(err);\n}\n","'use strict';\n\nconst { kForOnEventAttribute, kListener } = require('./constants');\n\nconst kCode = Symbol('kCode');\nconst kData = Symbol('kData');\nconst kError = Symbol('kError');\nconst kMessage = Symbol('kMessage');\nconst kReason = Symbol('kReason');\nconst kTarget = Symbol('kTarget');\nconst kType = Symbol('kType');\nconst kWasClean = Symbol('kWasClean');\n\n/**\n * Class representing an event.\n */\nclass Event {\n  /**\n   * Create a new `Event`.\n   *\n   * @param {String} type The name of the event\n   * @throws {TypeError} If the `type` argument is not specified\n   */\n  constructor(type) {\n    this[kTarget] = null;\n    this[kType] = type;\n  }\n\n  /**\n   * @type {*}\n   */\n  get target() {\n    return this[kTarget];\n  }\n\n  /**\n   * @type {String}\n   */\n  get type() {\n    return this[kType];\n  }\n}\n\nObject.defineProperty(Event.prototype, 'target', { enumerable: true });\nObject.defineProperty(Event.prototype, 'type', { enumerable: true });\n\n/**\n * Class representing a close event.\n *\n * @extends Event\n */\nclass CloseEvent extends Event {\n  /**\n   * Create a new `CloseEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {Number} [options.code=0] The status code explaining why the\n   *     connection was closed\n   * @param {String} [options.reason=''] A human-readable string explaining why\n   *     the connection was closed\n   * @param {Boolean} [options.wasClean=false] Indicates whether or not the\n   *     connection was cleanly closed\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kCode] = options.code === undefined ? 0 : options.code;\n    this[kReason] = options.reason === undefined ? '' : options.reason;\n    this[kWasClean] = options.wasClean === undefined ? false : options.wasClean;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get code() {\n    return this[kCode];\n  }\n\n  /**\n   * @type {String}\n   */\n  get reason() {\n    return this[kReason];\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get wasClean() {\n    return this[kWasClean];\n  }\n}\n\nObject.defineProperty(CloseEvent.prototype, 'code', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'reason', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'wasClean', { enumerable: true });\n\n/**\n * Class representing an error event.\n *\n * @extends Event\n */\nclass ErrorEvent extends Event {\n  /**\n   * Create a new `ErrorEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.error=null] The error that generated this event\n   * @param {String} [options.message=''] The error message\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kError] = options.error === undefined ? null : options.error;\n    this[kMessage] = options.message === undefined ? '' : options.message;\n  }\n\n  /**\n   * @type {*}\n   */\n  get error() {\n    return this[kError];\n  }\n\n  /**\n   * @type {String}\n   */\n  get message() {\n    return this[kMessage];\n  }\n}\n\nObject.defineProperty(ErrorEvent.prototype, 'error', { enumerable: true });\nObject.defineProperty(ErrorEvent.prototype, 'message', { enumerable: true });\n\n/**\n * Class representing a message event.\n *\n * @extends Event\n */\nclass MessageEvent extends Event {\n  /**\n   * Create a new `MessageEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.data=null] The message content\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kData] = options.data === undefined ? null : options.data;\n  }\n\n  /**\n   * @type {*}\n   */\n  get data() {\n    return this[kData];\n  }\n}\n\nObject.defineProperty(MessageEvent.prototype, 'data', { enumerable: true });\n\n/**\n * This provides methods for emulating the `EventTarget` interface. It's not\n * meant to be used directly.\n *\n * @mixin\n */\nconst EventTarget = {\n  /**\n   * Register an event listener.\n   *\n   * @param {String} type A string representing the event type to listen for\n   * @param {(Function|Object)} handler The listener to add\n   * @param {Object} [options] An options object specifies characteristics about\n   *     the event listener\n   * @param {Boolean} [options.once=false] A `Boolean` indicating that the\n   *     listener should be invoked at most once after being added. If `true`,\n   *     the listener would be automatically removed when invoked.\n   * @public\n   */\n  addEventListener(type, handler, options = {}) {\n    for (const listener of this.listeners(type)) {\n      if (\n        !options[kForOnEventAttribute] &&\n        listener[kListener] === handler &&\n        !listener[kForOnEventAttribute]\n      ) {\n        return;\n      }\n    }\n\n    let wrapper;\n\n    if (type === 'message') {\n      wrapper = function onMessage(data, isBinary) {\n        const event = new MessageEvent('message', {\n          data: isBinary ? data : data.toString()\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'close') {\n      wrapper = function onClose(code, message) {\n        const event = new CloseEvent('close', {\n          code,\n          reason: message.toString(),\n          wasClean: this._closeFrameReceived && this._closeFrameSent\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'error') {\n      wrapper = function onError(error) {\n        const event = new ErrorEvent('error', {\n          error,\n          message: error.message\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'open') {\n      wrapper = function onOpen() {\n        const event = new Event('open');\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else {\n      return;\n    }\n\n    wrapper[kForOnEventAttribute] = !!options[kForOnEventAttribute];\n    wrapper[kListener] = handler;\n\n    if (options.once) {\n      this.once(type, wrapper);\n    } else {\n      this.on(type, wrapper);\n    }\n  },\n\n  /**\n   * Remove an event listener.\n   *\n   * @param {String} type A string representing the event type to remove\n   * @param {(Function|Object)} handler The listener to remove\n   * @public\n   */\n  removeEventListener(type, handler) {\n    for (const listener of this.listeners(type)) {\n      if (listener[kListener] === handler && !listener[kForOnEventAttribute]) {\n        this.removeListener(type, listener);\n        break;\n      }\n    }\n  }\n};\n\nmodule.exports = {\n  CloseEvent,\n  ErrorEvent,\n  Event,\n  EventTarget,\n  MessageEvent\n};\n\n/**\n * Call an event listener\n *\n * @param {(Function|Object)} listener The listener to call\n * @param {*} thisArg The value to use as `this`` when calling the listener\n * @param {Event} event The event to pass to the listener\n * @private\n */\nfunction callListener(listener, thisArg, event) {\n  if (typeof listener === 'object' && listener.handleEvent) {\n    listener.handleEvent.call(listener, event);\n  } else {\n    listener.call(thisArg, event);\n  }\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex|Readable$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst https = require('https');\nconst http = require('http');\nconst net = require('net');\nconst tls = require('tls');\nconst { randomBytes, createHash } = require('crypto');\nconst { Duplex, Readable } = require('stream');\nconst { URL } = require('url');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst Receiver = require('./receiver');\nconst Sender = require('./sender');\nconst { isBlob } = require('./validation');\n\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  GUID,\n  kForOnEventAttribute,\n  kListener,\n  kStatusCode,\n  kWebSocket,\n  NOOP\n} = require('./constants');\nconst {\n  EventTarget: { addEventListener, removeEventListener }\n} = require('./event-target');\nconst { format, parse } = require('./extension');\nconst { toBuffer } = require('./buffer-util');\n\nconst closeTimeout = 30 * 1000;\nconst kAborted = Symbol('kAborted');\nconst protocolVersions = [8, 13];\nconst readyStates = ['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'];\nconst subprotocolRegex = /^[!#$%&'*+\\-.0-9A-Z^_`|a-z~]+$/;\n\n/**\n * Class representing a WebSocket.\n *\n * @extends EventEmitter\n */\nclass WebSocket extends EventEmitter {\n  /**\n   * Create a new `WebSocket`.\n   *\n   * @param {(String|URL)} address The URL to which to connect\n   * @param {(String|String[])} [protocols] The subprotocols\n   * @param {Object} [options] Connection options\n   */\n  constructor(address, protocols, options) {\n    super();\n\n    this._binaryType = BINARY_TYPES[0];\n    this._closeCode = 1006;\n    this._closeFrameReceived = false;\n    this._closeFrameSent = false;\n    this._closeMessage = EMPTY_BUFFER;\n    this._closeTimer = null;\n    this._errorEmitted = false;\n    this._extensions = {};\n    this._paused = false;\n    this._protocol = '';\n    this._readyState = WebSocket.CONNECTING;\n    this._receiver = null;\n    this._sender = null;\n    this._socket = null;\n\n    if (address !== null) {\n      this._bufferedAmount = 0;\n      this._isServer = false;\n      this._redirects = 0;\n\n      if (protocols === undefined) {\n        protocols = [];\n      } else if (!Array.isArray(protocols)) {\n        if (typeof protocols === 'object' && protocols !== null) {\n          options = protocols;\n          protocols = [];\n        } else {\n          protocols = [protocols];\n        }\n      }\n\n      initAsClient(this, address, protocols, options);\n    } else {\n      this._autoPong = options.autoPong;\n      this._isServer = true;\n    }\n  }\n\n  /**\n   * For historical reasons, the custom \"nodebuffer\" type is used by the default\n   * instead of \"blob\".\n   *\n   * @type {String}\n   */\n  get binaryType() {\n    return this._binaryType;\n  }\n\n  set binaryType(type) {\n    if (!BINARY_TYPES.includes(type)) return;\n\n    this._binaryType = type;\n\n    //\n    // Allow to change `binaryType` on the fly.\n    //\n    if (this._receiver) this._receiver._binaryType = type;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get bufferedAmount() {\n    if (!this._socket) return this._bufferedAmount;\n\n    return this._socket._writableState.length + this._sender._bufferedBytes;\n  }\n\n  /**\n   * @type {String}\n   */\n  get extensions() {\n    return Object.keys(this._extensions).join();\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get isPaused() {\n    return this._paused;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onclose() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onerror() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onopen() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onmessage() {\n    return null;\n  }\n\n  /**\n   * @type {String}\n   */\n  get protocol() {\n    return this._protocol;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get readyState() {\n    return this._readyState;\n  }\n\n  /**\n   * @type {String}\n   */\n  get url() {\n    return this._url;\n  }\n\n  /**\n   * Set up the socket and the internal resources.\n   *\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Object} options Options object\n   * @param {Boolean} [options.allowSynchronousEvents=false] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Number} [options.maxPayload=0] The maximum allowed message size\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @private\n   */\n  setSocket(socket, head, options) {\n    const receiver = new Receiver({\n      allowSynchronousEvents: options.allowSynchronousEvents,\n      binaryType: this.binaryType,\n      extensions: this._extensions,\n      isServer: this._isServer,\n      maxPayload: options.maxPayload,\n      skipUTF8Validation: options.skipUTF8Validation\n    });\n\n    const sender = new Sender(socket, this._extensions, options.generateMask);\n\n    this._receiver = receiver;\n    this._sender = sender;\n    this._socket = socket;\n\n    receiver[kWebSocket] = this;\n    sender[kWebSocket] = this;\n    socket[kWebSocket] = this;\n\n    receiver.on('conclude', receiverOnConclude);\n    receiver.on('drain', receiverOnDrain);\n    receiver.on('error', receiverOnError);\n    receiver.on('message', receiverOnMessage);\n    receiver.on('ping', receiverOnPing);\n    receiver.on('pong', receiverOnPong);\n\n    sender.onerror = senderOnError;\n\n    //\n    // These methods may not be available if `socket` is just a `Duplex`.\n    //\n    if (socket.setTimeout) socket.setTimeout(0);\n    if (socket.setNoDelay) socket.setNoDelay();\n\n    if (head.length > 0) socket.unshift(head);\n\n    socket.on('close', socketOnClose);\n    socket.on('data', socketOnData);\n    socket.on('end', socketOnEnd);\n    socket.on('error', socketOnError);\n\n    this._readyState = WebSocket.OPEN;\n    this.emit('open');\n  }\n\n  /**\n   * Emit the `'close'` event.\n   *\n   * @private\n   */\n  emitClose() {\n    if (!this._socket) {\n      this._readyState = WebSocket.CLOSED;\n      this.emit('close', this._closeCode, this._closeMessage);\n      return;\n    }\n\n    if (this._extensions[PerMessageDeflate.extensionName]) {\n      this._extensions[PerMessageDeflate.extensionName].cleanup();\n    }\n\n    this._receiver.removeAllListeners();\n    this._readyState = WebSocket.CLOSED;\n    this.emit('close', this._closeCode, this._closeMessage);\n  }\n\n  /**\n   * Start a closing handshake.\n   *\n   *          +----------+   +-----------+   +----------+\n   *     - - -|ws.close()|-->|close frame|-->|ws.close()|- - -\n   *    |     +----------+   +-----------+   +----------+     |\n   *          +----------+   +-----------+         |\n   * CLOSING  |ws.close()|<--|close frame|<--+-----+       CLOSING\n   *          +----------+   +-----------+   |\n   *    |           |                        |   +---+        |\n   *                +------------------------+-->|fin| - - - -\n   *    |         +---+                      |   +---+\n   *     - - - - -|fin|<---------------------+\n   *              +---+\n   *\n   * @param {Number} [code] Status code explaining why the connection is closing\n   * @param {(String|Buffer)} [data] The reason why the connection is\n   *     closing\n   * @public\n   */\n  close(code, data) {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this.readyState === WebSocket.CLOSING) {\n      if (\n        this._closeFrameSent &&\n        (this._closeFrameReceived || this._receiver._writableState.errorEmitted)\n      ) {\n        this._socket.end();\n      }\n\n      return;\n    }\n\n    this._readyState = WebSocket.CLOSING;\n    this._sender.close(code, data, !this._isServer, (err) => {\n      //\n      // This error is handled by the `'error'` listener on the socket. We only\n      // want to know if the close frame has been sent here.\n      //\n      if (err) return;\n\n      this._closeFrameSent = true;\n\n      if (\n        this._closeFrameReceived ||\n        this._receiver._writableState.errorEmitted\n      ) {\n        this._socket.end();\n      }\n    });\n\n    setCloseTimer(this);\n  }\n\n  /**\n   * Pause the socket.\n   *\n   * @public\n   */\n  pause() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = true;\n    this._socket.pause();\n  }\n\n  /**\n   * Send a ping.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the ping is sent\n   * @public\n   */\n  ping(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.ping(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Send a pong.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the pong is sent\n   * @public\n   */\n  pong(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.pong(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Resume the socket.\n   *\n   * @public\n   */\n  resume() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = false;\n    if (!this._receiver._writableState.needDrain) this._socket.resume();\n  }\n\n  /**\n   * Send a data message.\n   *\n   * @param {*} data The message to send\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.binary] Specifies whether `data` is binary or\n   *     text\n   * @param {Boolean} [options.compress] Specifies whether or not to compress\n   *     `data`\n   * @param {Boolean} [options.fin=true] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when data is written out\n   * @public\n   */\n  send(data, options, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof options === 'function') {\n      cb = options;\n      options = {};\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    const opts = {\n      binary: typeof data !== 'string',\n      mask: !this._isServer,\n      compress: true,\n      fin: true,\n      ...options\n    };\n\n    if (!this._extensions[PerMessageDeflate.extensionName]) {\n      opts.compress = false;\n    }\n\n    this._sender.send(data || EMPTY_BUFFER, opts, cb);\n  }\n\n  /**\n   * Forcibly close the connection.\n   *\n   * @public\n   */\n  terminate() {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this._socket) {\n      this._readyState = WebSocket.CLOSING;\n      this._socket.destroy();\n    }\n  }\n}\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n[\n  'binaryType',\n  'bufferedAmount',\n  'extensions',\n  'isPaused',\n  'protocol',\n  'readyState',\n  'url'\n].forEach((property) => {\n  Object.defineProperty(WebSocket.prototype, property, { enumerable: true });\n});\n\n//\n// Add the `onopen`, `onerror`, `onclose`, and `onmessage` attributes.\n// See https://html.spec.whatwg.org/multipage/comms.html#the-websocket-interface\n//\n['open', 'error', 'close', 'message'].forEach((method) => {\n  Object.defineProperty(WebSocket.prototype, `on${method}`, {\n    enumerable: true,\n    get() {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) return listener[kListener];\n      }\n\n      return null;\n    },\n    set(handler) {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) {\n          this.removeListener(method, listener);\n          break;\n        }\n      }\n\n      if (typeof handler !== 'function') return;\n\n      this.addEventListener(method, handler, {\n        [kForOnEventAttribute]: true\n      });\n    }\n  });\n});\n\nWebSocket.prototype.addEventListener = addEventListener;\nWebSocket.prototype.removeEventListener = removeEventListener;\n\nmodule.exports = WebSocket;\n\n/**\n * Initialize a WebSocket client.\n *\n * @param {WebSocket} websocket The client to initialize\n * @param {(String|URL)} address The URL to which to connect\n * @param {Array} protocols The subprotocols\n * @param {Object} [options] Connection options\n * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether any\n *     of the `'message'`, `'ping'`, and `'pong'` events can be emitted multiple\n *     times in the same tick\n * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n *     automatically send a pong in response to a ping\n * @param {Function} [options.finishRequest] A function which can be used to\n *     customize the headers of each http request before it is sent\n * @param {Boolean} [options.followRedirects=false] Whether or not to follow\n *     redirects\n * @param {Function} [options.generateMask] The function used to generate the\n *     masking key\n * @param {Number} [options.handshakeTimeout] Timeout in milliseconds for the\n *     handshake request\n * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n *     size\n * @param {Number} [options.maxRedirects=10] The maximum number of redirects\n *     allowed\n * @param {String} [options.origin] Value of the `Origin` or\n *     `Sec-WebSocket-Origin` header\n * @param {(Boolean|Object)} [options.perMessageDeflate=true] Enable/disable\n *     permessage-deflate\n * @param {Number} [options.protocolVersion=13] Value of the\n *     `Sec-WebSocket-Version` header\n * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n *     not to skip UTF-8 validation for text and close messages\n * @private\n */\nfunction initAsClient(websocket, address, protocols, options) {\n  const opts = {\n    allowSynchronousEvents: true,\n    autoPong: true,\n    protocolVersion: protocolVersions[1],\n    maxPayload: 100 * 1024 * 1024,\n    skipUTF8Validation: false,\n    perMessageDeflate: true,\n    followRedirects: false,\n    maxRedirects: 10,\n    ...options,\n    socketPath: undefined,\n    hostname: undefined,\n    protocol: undefined,\n    timeout: undefined,\n    method: 'GET',\n    host: undefined,\n    path: undefined,\n    port: undefined\n  };\n\n  websocket._autoPong = opts.autoPong;\n\n  if (!protocolVersions.includes(opts.protocolVersion)) {\n    throw new RangeError(\n      `Unsupported protocol version: ${opts.protocolVersion} ` +\n        `(supported versions: ${protocolVersions.join(', ')})`\n    );\n  }\n\n  let parsedUrl;\n\n  if (address instanceof URL) {\n    parsedUrl = address;\n  } else {\n    try {\n      parsedUrl = new URL(address);\n    } catch (e) {\n      throw new SyntaxError(`Invalid URL: ${address}`);\n    }\n  }\n\n  if (parsedUrl.protocol === 'http:') {\n    parsedUrl.protocol = 'ws:';\n  } else if (parsedUrl.protocol === 'https:') {\n    parsedUrl.protocol = 'wss:';\n  }\n\n  websocket._url = parsedUrl.href;\n\n  const isSecure = parsedUrl.protocol === 'wss:';\n  const isIpcUrl = parsedUrl.protocol === 'ws+unix:';\n  let invalidUrlMessage;\n\n  if (parsedUrl.protocol !== 'ws:' && !isSecure && !isIpcUrl) {\n    invalidUrlMessage =\n      'The URL\\'s protocol must be one of \"ws:\", \"wss:\", ' +\n      '\"http:\", \"https\", or \"ws+unix:\"';\n  } else if (isIpcUrl && !parsedUrl.pathname) {\n    invalidUrlMessage = \"The URL's pathname is empty\";\n  } else if (parsedUrl.hash) {\n    invalidUrlMessage = 'The URL contains a fragment identifier';\n  }\n\n  if (invalidUrlMessage) {\n    const err = new SyntaxError(invalidUrlMessage);\n\n    if (websocket._redirects === 0) {\n      throw err;\n    } else {\n      emitErrorAndClose(websocket, err);\n      return;\n    }\n  }\n\n  const defaultPort = isSecure ? 443 : 80;\n  const key = randomBytes(16).toString('base64');\n  const request = isSecure ? https.request : http.request;\n  const protocolSet = new Set();\n  let perMessageDeflate;\n\n  opts.createConnection =\n    opts.createConnection || (isSecure ? tlsConnect : netConnect);\n  opts.defaultPort = opts.defaultPort || defaultPort;\n  opts.port = parsedUrl.port || defaultPort;\n  opts.host = parsedUrl.hostname.startsWith('[')\n    ? parsedUrl.hostname.slice(1, -1)\n    : parsedUrl.hostname;\n  opts.headers = {\n    ...opts.headers,\n    'Sec-WebSocket-Version': opts.protocolVersion,\n    'Sec-WebSocket-Key': key,\n    Connection: 'Upgrade',\n    Upgrade: 'websocket'\n  };\n  opts.path = parsedUrl.pathname + parsedUrl.search;\n  opts.timeout = opts.handshakeTimeout;\n\n  if (opts.perMessageDeflate) {\n    perMessageDeflate = new PerMessageDeflate(\n      opts.perMessageDeflate !== true ? opts.perMessageDeflate : {},\n      false,\n      opts.maxPayload\n    );\n    opts.headers['Sec-WebSocket-Extensions'] = format({\n      [PerMessageDeflate.extensionName]: perMessageDeflate.offer()\n    });\n  }\n  if (protocols.length) {\n    for (const protocol of protocols) {\n      if (\n        typeof protocol !== 'string' ||\n        !subprotocolRegex.test(protocol) ||\n        protocolSet.has(protocol)\n      ) {\n        throw new SyntaxError(\n          'An invalid or duplicated subprotocol was specified'\n        );\n      }\n\n      protocolSet.add(protocol);\n    }\n\n    opts.headers['Sec-WebSocket-Protocol'] = protocols.join(',');\n  }\n  if (opts.origin) {\n    if (opts.protocolVersion < 13) {\n      opts.headers['Sec-WebSocket-Origin'] = opts.origin;\n    } else {\n      opts.headers.Origin = opts.origin;\n    }\n  }\n  if (parsedUrl.username || parsedUrl.password) {\n    opts.auth = `${parsedUrl.username}:${parsedUrl.password}`;\n  }\n\n  if (isIpcUrl) {\n    const parts = opts.path.split(':');\n\n    opts.socketPath = parts[0];\n    opts.path = parts[1];\n  }\n\n  let req;\n\n  if (opts.followRedirects) {\n    if (websocket._redirects === 0) {\n      websocket._originalIpc = isIpcUrl;\n      websocket._originalSecure = isSecure;\n      websocket._originalHostOrSocketPath = isIpcUrl\n        ? opts.socketPath\n        : parsedUrl.host;\n\n      const headers = options && options.headers;\n\n      //\n      // Shallow copy the user provided options so that headers can be changed\n      // without mutating the original object.\n      //\n      options = { ...options, headers: {} };\n\n      if (headers) {\n        for (const [key, value] of Object.entries(headers)) {\n          options.headers[key.toLowerCase()] = value;\n        }\n      }\n    } else if (websocket.listenerCount('redirect') === 0) {\n      const isSameHost = isIpcUrl\n        ? websocket._originalIpc\n          ? opts.socketPath === websocket._originalHostOrSocketPath\n          : false\n        : websocket._originalIpc\n          ? false\n          : parsedUrl.host === websocket._originalHostOrSocketPath;\n\n      if (!isSameHost || (websocket._originalSecure && !isSecure)) {\n        //\n        // Match curl 7.77.0 behavior and drop the following headers. These\n        // headers are also dropped when following a redirect to a subdomain.\n        //\n        delete opts.headers.authorization;\n        delete opts.headers.cookie;\n\n        if (!isSameHost) delete opts.headers.host;\n\n        opts.auth = undefined;\n      }\n    }\n\n    //\n    // Match curl 7.77.0 behavior and make the first `Authorization` header win.\n    // If the `Authorization` header is set, then there is nothing to do as it\n    // will take precedence.\n    //\n    if (opts.auth && !options.headers.authorization) {\n      options.headers.authorization =\n        'Basic ' + Buffer.from(opts.auth).toString('base64');\n    }\n\n    req = websocket._req = request(opts);\n\n    if (websocket._redirects) {\n      //\n      // Unlike what is done for the `'upgrade'` event, no early exit is\n      // triggered here if the user calls `websocket.close()` or\n      // `websocket.terminate()` from a listener of the `'redirect'` event. This\n      // is because the user can also call `request.destroy()` with an error\n      // before calling `websocket.close()` or `websocket.terminate()` and this\n      // would result in an error being emitted on the `request` object with no\n      // `'error'` event listeners attached.\n      //\n      websocket.emit('redirect', websocket.url, req);\n    }\n  } else {\n    req = websocket._req = request(opts);\n  }\n\n  if (opts.timeout) {\n    req.on('timeout', () => {\n      abortHandshake(websocket, req, 'Opening handshake has timed out');\n    });\n  }\n\n  req.on('error', (err) => {\n    if (req === null || req[kAborted]) return;\n\n    req = websocket._req = null;\n    emitErrorAndClose(websocket, err);\n  });\n\n  req.on('response', (res) => {\n    const location = res.headers.location;\n    const statusCode = res.statusCode;\n\n    if (\n      location &&\n      opts.followRedirects &&\n      statusCode >= 300 &&\n      statusCode < 400\n    ) {\n      if (++websocket._redirects > opts.maxRedirects) {\n        abortHandshake(websocket, req, 'Maximum redirects exceeded');\n        return;\n      }\n\n      req.abort();\n\n      let addr;\n\n      try {\n        addr = new URL(location, address);\n      } catch (e) {\n        const err = new SyntaxError(`Invalid URL: ${location}`);\n        emitErrorAndClose(websocket, err);\n        return;\n      }\n\n      initAsClient(websocket, addr, protocols, options);\n    } else if (!websocket.emit('unexpected-response', req, res)) {\n      abortHandshake(\n        websocket,\n        req,\n        `Unexpected server response: ${res.statusCode}`\n      );\n    }\n  });\n\n  req.on('upgrade', (res, socket, head) => {\n    websocket.emit('upgrade', res);\n\n    //\n    // The user may have closed the connection from a listener of the\n    // `'upgrade'` event.\n    //\n    if (websocket.readyState !== WebSocket.CONNECTING) return;\n\n    req = websocket._req = null;\n\n    const upgrade = res.headers.upgrade;\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      abortHandshake(websocket, socket, 'Invalid Upgrade header');\n      return;\n    }\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    if (res.headers['sec-websocket-accept'] !== digest) {\n      abortHandshake(websocket, socket, 'Invalid Sec-WebSocket-Accept header');\n      return;\n    }\n\n    const serverProt = res.headers['sec-websocket-protocol'];\n    let protError;\n\n    if (serverProt !== undefined) {\n      if (!protocolSet.size) {\n        protError = 'Server sent a subprotocol but none was requested';\n      } else if (!protocolSet.has(serverProt)) {\n        protError = 'Server sent an invalid subprotocol';\n      }\n    } else if (protocolSet.size) {\n      protError = 'Server sent no subprotocol';\n    }\n\n    if (protError) {\n      abortHandshake(websocket, socket, protError);\n      return;\n    }\n\n    if (serverProt) websocket._protocol = serverProt;\n\n    const secWebSocketExtensions = res.headers['sec-websocket-extensions'];\n\n    if (secWebSocketExtensions !== undefined) {\n      if (!perMessageDeflate) {\n        const message =\n          'Server sent a Sec-WebSocket-Extensions header but no extension ' +\n          'was requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      let extensions;\n\n      try {\n        extensions = parse(secWebSocketExtensions);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      const extensionNames = Object.keys(extensions);\n\n      if (\n        extensionNames.length !== 1 ||\n        extensionNames[0] !== PerMessageDeflate.extensionName\n      ) {\n        const message = 'Server indicated an extension that was not requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      try {\n        perMessageDeflate.accept(extensions[PerMessageDeflate.extensionName]);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      websocket._extensions[PerMessageDeflate.extensionName] =\n        perMessageDeflate;\n    }\n\n    websocket.setSocket(socket, head, {\n      allowSynchronousEvents: opts.allowSynchronousEvents,\n      generateMask: opts.generateMask,\n      maxPayload: opts.maxPayload,\n      skipUTF8Validation: opts.skipUTF8Validation\n    });\n  });\n\n  if (opts.finishRequest) {\n    opts.finishRequest(req, websocket);\n  } else {\n    req.end();\n  }\n}\n\n/**\n * Emit the `'error'` and `'close'` events.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {Error} The error to emit\n * @private\n */\nfunction emitErrorAndClose(websocket, err) {\n  websocket._readyState = WebSocket.CLOSING;\n  //\n  // The following assignment is practically useless and is done only for\n  // consistency.\n  //\n  websocket._errorEmitted = true;\n  websocket.emit('error', err);\n  websocket.emitClose();\n}\n\n/**\n * Create a `net.Socket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {net.Socket} The newly created socket used to start the connection\n * @private\n */\nfunction netConnect(options) {\n  options.path = options.socketPath;\n  return net.connect(options);\n}\n\n/**\n * Create a `tls.TLSSocket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {tls.TLSSocket} The newly created socket used to start the connection\n * @private\n */\nfunction tlsConnect(options) {\n  options.path = undefined;\n\n  if (!options.servername && options.servername !== '') {\n    options.servername = net.isIP(options.host) ? '' : options.host;\n  }\n\n  return tls.connect(options);\n}\n\n/**\n * Abort the handshake and emit an error.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {(http.ClientRequest|net.Socket|tls.Socket)} stream The request to\n *     abort or the socket to destroy\n * @param {String} message The error message\n * @private\n */\nfunction abortHandshake(websocket, stream, message) {\n  websocket._readyState = WebSocket.CLOSING;\n\n  const err = new Error(message);\n  Error.captureStackTrace(err, abortHandshake);\n\n  if (stream.setHeader) {\n    stream[kAborted] = true;\n    stream.abort();\n\n    if (stream.socket && !stream.socket.destroyed) {\n      //\n      // On Node.js >= 14.3.0 `request.abort()` does not destroy the socket if\n      // called after the request completed. See\n      // https://github.com/websockets/ws/issues/1869.\n      //\n      stream.socket.destroy();\n    }\n\n    process.nextTick(emitErrorAndClose, websocket, err);\n  } else {\n    stream.destroy(err);\n    stream.once('error', websocket.emit.bind(websocket, 'error'));\n    stream.once('close', websocket.emitClose.bind(websocket));\n  }\n}\n\n/**\n * Handle cases where the `ping()`, `pong()`, or `send()` methods are called\n * when the `readyState` attribute is `CLOSING` or `CLOSED`.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {*} [data] The data to send\n * @param {Function} [cb] Callback\n * @private\n */\nfunction sendAfterClose(websocket, data, cb) {\n  if (data) {\n    const length = isBlob(data) ? data.size : toBuffer(data).length;\n\n    //\n    // The `_bufferedAmount` property is used only when the peer is a client and\n    // the opening handshake fails. Under these circumstances, in fact, the\n    // `setSocket()` method is not called, so the `_socket` and `_sender`\n    // properties are set to `null`.\n    //\n    if (websocket._socket) websocket._sender._bufferedBytes += length;\n    else websocket._bufferedAmount += length;\n  }\n\n  if (cb) {\n    const err = new Error(\n      `WebSocket is not open: readyState ${websocket.readyState} ` +\n        `(${readyStates[websocket.readyState]})`\n    );\n    process.nextTick(cb, err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'conclude'` event.\n *\n * @param {Number} code The status code\n * @param {Buffer} reason The reason for closing\n * @private\n */\nfunction receiverOnConclude(code, reason) {\n  const websocket = this[kWebSocket];\n\n  websocket._closeFrameReceived = true;\n  websocket._closeMessage = reason;\n  websocket._closeCode = code;\n\n  if (websocket._socket[kWebSocket] === undefined) return;\n\n  websocket._socket.removeListener('data', socketOnData);\n  process.nextTick(resume, websocket._socket);\n\n  if (code === 1005) websocket.close();\n  else websocket.close(code, reason);\n}\n\n/**\n * The listener of the `Receiver` `'drain'` event.\n *\n * @private\n */\nfunction receiverOnDrain() {\n  const websocket = this[kWebSocket];\n\n  if (!websocket.isPaused) websocket._socket.resume();\n}\n\n/**\n * The listener of the `Receiver` `'error'` event.\n *\n * @param {(RangeError|Error)} err The emitted error\n * @private\n */\nfunction receiverOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._socket[kWebSocket] !== undefined) {\n    websocket._socket.removeListener('data', socketOnData);\n\n    //\n    // On Node.js < 14.0.0 the `'error'` event is emitted synchronously. See\n    // https://github.com/websockets/ws/issues/1940.\n    //\n    process.nextTick(resume, websocket._socket);\n\n    websocket.close(err[kStatusCode]);\n  }\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'finish'` event.\n *\n * @private\n */\nfunction receiverOnFinish() {\n  this[kWebSocket].emitClose();\n}\n\n/**\n * The listener of the `Receiver` `'message'` event.\n *\n * @param {Buffer|ArrayBuffer|Buffer[])} data The message\n * @param {Boolean} isBinary Specifies whether the message is binary or not\n * @private\n */\nfunction receiverOnMessage(data, isBinary) {\n  this[kWebSocket].emit('message', data, isBinary);\n}\n\n/**\n * The listener of the `Receiver` `'ping'` event.\n *\n * @param {Buffer} data The data included in the ping frame\n * @private\n */\nfunction receiverOnPing(data) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._autoPong) websocket.pong(data, !this._isServer, NOOP);\n  websocket.emit('ping', data);\n}\n\n/**\n * The listener of the `Receiver` `'pong'` event.\n *\n * @param {Buffer} data The data included in the pong frame\n * @private\n */\nfunction receiverOnPong(data) {\n  this[kWebSocket].emit('pong', data);\n}\n\n/**\n * Resume a readable stream\n *\n * @param {Readable} stream The readable stream\n * @private\n */\nfunction resume(stream) {\n  stream.resume();\n}\n\n/**\n * The `Sender` error event handler.\n *\n * @param {Error} The error\n * @private\n */\nfunction senderOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket.readyState === WebSocket.CLOSED) return;\n  if (websocket.readyState === WebSocket.OPEN) {\n    websocket._readyState = WebSocket.CLOSING;\n    setCloseTimer(websocket);\n  }\n\n  //\n  // `socket.end()` is used instead of `socket.destroy()` to allow the other\n  // peer to finish sending queued data. There is no need to set a timer here\n  // because `CLOSING` means that it is already set or not needed.\n  //\n  this._socket.end();\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * Set a timer to destroy the underlying raw socket of a WebSocket.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @private\n */\nfunction setCloseTimer(websocket) {\n  websocket._closeTimer = setTimeout(\n    websocket._socket.destroy.bind(websocket._socket),\n    closeTimeout\n  );\n}\n\n/**\n * The listener of the socket `'close'` event.\n *\n * @private\n */\nfunction socketOnClose() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('close', socketOnClose);\n  this.removeListener('data', socketOnData);\n  this.removeListener('end', socketOnEnd);\n\n  websocket._readyState = WebSocket.CLOSING;\n\n  let chunk;\n\n  //\n  // The close frame might not have been received or the `'end'` event emitted,\n  // for example, if the socket was destroyed due to an error. Ensure that the\n  // `receiver` stream is closed after writing any remaining buffered data to\n  // it. If the readable side of the socket is in flowing mode then there is no\n  // buffered data as everything has been already written and `readable.read()`\n  // will return `null`. If instead, the socket is paused, any possible buffered\n  // data will be read as a single chunk.\n  //\n  if (\n    !this._readableState.endEmitted &&\n    !websocket._closeFrameReceived &&\n    !websocket._receiver._writableState.errorEmitted &&\n    (chunk = websocket._socket.read()) !== null\n  ) {\n    websocket._receiver.write(chunk);\n  }\n\n  websocket._receiver.end();\n\n  this[kWebSocket] = undefined;\n\n  clearTimeout(websocket._closeTimer);\n\n  if (\n    websocket._receiver._writableState.finished ||\n    websocket._receiver._writableState.errorEmitted\n  ) {\n    websocket.emitClose();\n  } else {\n    websocket._receiver.on('error', receiverOnFinish);\n    websocket._receiver.on('finish', receiverOnFinish);\n  }\n}\n\n/**\n * The listener of the socket `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction socketOnData(chunk) {\n  if (!this[kWebSocket]._receiver.write(chunk)) {\n    this.pause();\n  }\n}\n\n/**\n * The listener of the socket `'end'` event.\n *\n * @private\n */\nfunction socketOnEnd() {\n  const websocket = this[kWebSocket];\n\n  websocket._readyState = WebSocket.CLOSING;\n  websocket._receiver.end();\n  this.end();\n}\n\n/**\n * The listener of the socket `'error'` event.\n *\n * @private\n */\nfunction socketOnError() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('error', socketOnError);\n  this.on('error', NOOP);\n\n  if (websocket) {\n    websocket._readyState = WebSocket.CLOSING;\n    this.destroy();\n  }\n}\n","'use strict';\n\nconst { EMPTY_BUFFER } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\n\n/**\n * Merges an array of buffers into a new buffer.\n *\n * @param {Buffer[]} list The array of buffers to concat\n * @param {Number} totalLength The total length of buffers in the list\n * @return {Buffer} The resulting buffer\n * @public\n */\nfunction concat(list, totalLength) {\n  if (list.length === 0) return EMPTY_BUFFER;\n  if (list.length === 1) return list[0];\n\n  const target = Buffer.allocUnsafe(totalLength);\n  let offset = 0;\n\n  for (let i = 0; i < list.length; i++) {\n    const buf = list[i];\n    target.set(buf, offset);\n    offset += buf.length;\n  }\n\n  if (offset < totalLength) {\n    return new FastBuffer(target.buffer, target.byteOffset, offset);\n  }\n\n  return target;\n}\n\n/**\n * Masks a buffer using the given mask.\n *\n * @param {Buffer} source The buffer to mask\n * @param {Buffer} mask The mask to use\n * @param {Buffer} output The buffer where to store the result\n * @param {Number} offset The offset at which to start writing\n * @param {Number} length The number of bytes to mask.\n * @public\n */\nfunction _mask(source, mask, output, offset, length) {\n  for (let i = 0; i < length; i++) {\n    output[offset + i] = source[i] ^ mask[i & 3];\n  }\n}\n\n/**\n * Unmasks a buffer using the given mask.\n *\n * @param {Buffer} buffer The buffer to unmask\n * @param {Buffer} mask The mask to use\n * @public\n */\nfunction _unmask(buffer, mask) {\n  for (let i = 0; i < buffer.length; i++) {\n    buffer[i] ^= mask[i & 3];\n  }\n}\n\n/**\n * Converts a buffer to an `ArrayBuffer`.\n *\n * @param {Buffer} buf The buffer to convert\n * @return {ArrayBuffer} Converted buffer\n * @public\n */\nfunction toArrayBuffer(buf) {\n  if (buf.length === buf.buffer.byteLength) {\n    return buf.buffer;\n  }\n\n  return buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.length);\n}\n\n/**\n * Converts `data` to a `Buffer`.\n *\n * @param {*} data The data to convert\n * @return {Buffer} The buffer\n * @throws {TypeError}\n * @public\n */\nfunction toBuffer(data) {\n  toBuffer.readOnly = true;\n\n  if (Buffer.isBuffer(data)) return data;\n\n  let buf;\n\n  if (data instanceof ArrayBuffer) {\n    buf = new FastBuffer(data);\n  } else if (ArrayBuffer.isView(data)) {\n    buf = new FastBuffer(data.buffer, data.byteOffset, data.byteLength);\n  } else {\n    buf = Buffer.from(data);\n    toBuffer.readOnly = false;\n  }\n\n  return buf;\n}\n\nmodule.exports = {\n  concat,\n  mask: _mask,\n  toArrayBuffer,\n  toBuffer,\n  unmask: _unmask\n};\n\n/* istanbul ignore else  */\nif (!process.env.WS_NO_BUFFER_UTIL) {\n  try {\n    const bufferUtil = require('bufferutil');\n\n    module.exports.mask = function (source, mask, output, offset, length) {\n      if (length < 48) _mask(source, mask, output, offset, length);\n      else bufferUtil.mask(source, mask, output, offset, length);\n    };\n\n    module.exports.unmask = function (buffer, mask) {\n      if (buffer.length < 32) _unmask(buffer, mask);\n      else bufferUtil.unmask(buffer, mask);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\nconst { isUtf8 } = require('buffer');\n\nconst { hasBlob } = require('./constants');\n\n//\n// Allowed token characters:\n//\n// '!', '#', '$', '%', '&', ''', '*', '+', '-',\n// '.', 0-9, A-Z, '^', '_', '`', a-z, '|', '~'\n//\n// tokenChars[32] === 0 // ' '\n// tokenChars[33] === 1 // '!'\n// tokenChars[34] === 0 // '\"'\n// ...\n//\n// prettier-ignore\nconst tokenChars = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 0 - 15\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 16 - 31\n  0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, // 32 - 47\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, // 48 - 63\n  0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 64 - 79\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, // 80 - 95\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 96 - 111\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0 // 112 - 127\n];\n\n/**\n * Checks if a status code is allowed in a close frame.\n *\n * @param {Number} code The status code\n * @return {Boolean} `true` if the status code is valid, else `false`\n * @public\n */\nfunction isValidStatusCode(code) {\n  return (\n    (code >= 1000 &&\n      code <= 1014 &&\n      code !== 1004 &&\n      code !== 1005 &&\n      code !== 1006) ||\n    (code >= 3000 && code <= 4999)\n  );\n}\n\n/**\n * Checks if a given buffer contains only correct UTF-8.\n * Ported from https://www.cl.cam.ac.uk/%7Emgk25/ucs/utf8_check.c by\n * Markus Kuhn.\n *\n * @param {Buffer} buf The buffer to check\n * @return {Boolean} `true` if `buf` contains only correct UTF-8, else `false`\n * @public\n */\nfunction _isValidUTF8(buf) {\n  const len = buf.length;\n  let i = 0;\n\n  while (i < len) {\n    if ((buf[i] & 0x80) === 0) {\n      // 0xxxxxxx\n      i++;\n    } else if ((buf[i] & 0xe0) === 0xc0) {\n      // 110xxxxx 10xxxxxx\n      if (\n        i + 1 === len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i] & 0xfe) === 0xc0 // Overlong\n      ) {\n        return false;\n      }\n\n      i += 2;\n    } else if ((buf[i] & 0xf0) === 0xe0) {\n      // 1110xxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 2 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xe0 && (buf[i + 1] & 0xe0) === 0x80) || // Overlong\n        (buf[i] === 0xed && (buf[i + 1] & 0xe0) === 0xa0) // Surrogate (U+D800 - U+DFFF)\n      ) {\n        return false;\n      }\n\n      i += 3;\n    } else if ((buf[i] & 0xf8) === 0xf0) {\n      // 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 3 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i + 3] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xf0 && (buf[i + 1] & 0xf0) === 0x80) || // Overlong\n        (buf[i] === 0xf4 && buf[i + 1] > 0x8f) ||\n        buf[i] > 0xf4 // > U+10FFFF\n      ) {\n        return false;\n      }\n\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Determines whether a value is a `Blob`.\n *\n * @param {*} value The value to be tested\n * @return {Boolean} `true` if `value` is a `Blob`, else `false`\n * @private\n */\nfunction isBlob(value) {\n  return (\n    hasBlob &&\n    typeof value === 'object' &&\n    typeof value.arrayBuffer === 'function' &&\n    typeof value.type === 'string' &&\n    typeof value.stream === 'function' &&\n    (value[Symbol.toStringTag] === 'Blob' ||\n      value[Symbol.toStringTag] === 'File')\n  );\n}\n\nmodule.exports = {\n  isBlob,\n  isValidStatusCode,\n  isValidUTF8: _isValidUTF8,\n  tokenChars\n};\n\nif (isUtf8) {\n  module.exports.isValidUTF8 = function (buf) {\n    return buf.length < 24 ? _isValidUTF8(buf) : isUtf8(buf);\n  };\n} /* istanbul ignore else  */ else if (!process.env.WS_NO_UTF_8_VALIDATE) {\n  try {\n    const isValidUTF8 = require('utf-8-validate');\n\n    module.exports.isValidUTF8 = function (buf) {\n      return buf.length < 32 ? _isValidUTF8(buf) : isValidUTF8(buf);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\n/**\n * Checks if a given buffer contains only correct UTF-8.\n * Ported from https://www.cl.cam.ac.uk/%7Emgk25/ucs/utf8_check.c by\n * Markus Kuhn.\n *\n * @param {Buffer} buf The buffer to check\n * @return {Boolean} `true` if `buf` contains only correct UTF-8, else `false`\n * @public\n */\nfunction isValidUTF8(buf) {\n  const len = buf.length;\n  let i = 0;\n\n  while (i < len) {\n    if ((buf[i] & 0x80) === 0x00) {  // 0xxxxxxx\n      i++;\n    } else if ((buf[i] & 0xe0) === 0xc0) {  // 110xxxxx 10xxxxxx\n      if (\n        i + 1 === len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i] & 0xfe) === 0xc0  // overlong\n      ) {\n        return false;\n      }\n\n      i += 2;\n    } else if ((buf[i] & 0xf0) === 0xe0) {  // 1110xxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 2 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        buf[i] === 0xe0 && (buf[i + 1] & 0xe0) === 0x80 ||  // overlong\n        buf[i] === 0xed && (buf[i + 1] & 0xe0) === 0xa0  // surrogate (U+D800 - U+DFFF)\n      ) {\n        return false;\n      }\n\n      i += 3;\n    } else if ((buf[i] & 0xf8) === 0xf0) {  // 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 3 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i + 3] & 0xc0) !== 0x80 ||\n        buf[i] === 0xf0 && (buf[i + 1] & 0xf0) === 0x80 ||  // overlong\n        buf[i] === 0xf4 && buf[i + 1] > 0x8f || buf[i] > 0xf4  // > U+10FFFF\n      ) {\n        return false;\n      }\n\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nmodule.exports = isValidUTF8;\n"],"names":["fs","path","os","runtimeRequire","vars","process","config","variables","prebuildsOnly","env","PREBUILDS_ONLY","abi","versions","modules","runtime","electron","ELECTRON_RUN_AS_NODE","window","type","nw","arch","npm_config_arch","platform","npm_config_platform","libc","LIBC","existsSync","isAlpine","armv","ARM_VERSION","arm_version","uv","split","load","dir","resolve","readdirSync","err","getFirst","filter","files","join","matchBuild","name","test","parseTuple","arr","length","architectures","every","Boolean","matchTuple","tuple","includes","compareTuples","a","b","parseTags","file","tags","specificity","pop","i","tag","napi","slice","matchTags","runtimeAgnostic","compareTags","module","exports","toUpperCase","replace","release","debug","prebuild","nearby","dirname","execPath","target","node","Error","map","sort","prebuilds","winner","Duplex","emitClose","stream","emit","duplexOnEnd","this","destroyed","_writableState","finished","destroy","duplexOnError","removeListener","listenerCount","ws","options","terminateOnDestroy","duplex","autoDestroy","objectMode","writableObjectMode","on","msg","isBinary","data","_readableState","toString","push","pause","once","_destroy","callback","readyState","CLOSED","nextTick","called","terminate","_final","CONNECTING","_socket","endEmitted","close","_read","isPaused","resume","_write","chunk","encoding","send","kDone","Symbol","kRun","constructor","concurrency","pending","Infinity","jobs","add","job","shift","__dirname","e","tokenChars","parse","header","protocols","Set","start","end","code","charCodeAt","SyntaxError","protocol","has","BINARY_TYPES","hasBlob","Blob","EMPTY_BUFFER","Buffer","alloc","GUID","kForOnEventAttribute","kListener","kStatusCode","kWebSocket","NOOP","zlib","bufferUtil","Limiter","FastBuffer","species","TRAILER","from","kPerMessageDeflate","kTotalLength","kCallback","kBuffers","kError","zlibLimiter","deflateOnData","inflateOnData","_maxPayload","RangeError","reset","inflateOnError","_inflate","isServer","maxPayload","_options","_threshold","undefined","threshold","_isServer","_deflate","params","concurrencyLimit","extensionName","offer","serverNoContextTakeover","server_no_context_takeover","clientNoContextTakeover","client_no_context_takeover","serverMaxWindowBits","server_max_window_bits","clientMaxWindowBits","client_max_window_bits","accept","configurations","normalizeParams","acceptAsServer","acceptAsClient","cleanup","offers","opts","accepted","find","response","forEach","Object","keys","key","value","num","Number","isInteger","TypeError","decompress","fin","done","_decompress","result","compress","_compress","endpoint","windowBits","Z_DEFAULT_WINDOWBITS","createInflateRaw","zlibInflateOptions","write","flush","concat","createDeflateRaw","zlibDeflateOptions","Z_SYNC_FLUSH","buffer","byteOffset","Writable","PerMessageDeflate","toArrayBuffer","unmask","isValidStatusCode","isValidUTF8","super","_allowSynchronousEvents","allowSynchronousEvents","_binaryType","binaryType","_extensions","extensions","_skipUTF8Validation","skipUTF8Validation","_bufferedBytes","_buffers","_compressed","_payloadLength","_mask","_fragmented","_masked","_fin","_opcode","_totalPayloadLength","_messageLength","_fragments","_errored","_loop","_state","cb","startLoop","consume","n","buf","dst","allocUnsafe","offset","set","Uint8Array","getInfo","getPayloadLength16","getPayloadLength64","getMask","getData","createError","compressed","haveLength","readUInt16BE","readUInt32BE","Math","pow","controlMessage","dataMessage","error","messageLength","fragments","setImmediate","ErrorCtor","message","prefix","statusCode","errorCode","captureStackTrace","dest","elem","format","extension","Array","isArray","k","values","v","create","paramName","mustUnescape","isEscaping","inQuotes","token","EventEmitter","http","createHash","subprotocol","WebSocket","keyRegex","server","socketOnError","abortHandshake","socket","headers","STATUS_CODES","Connection","byteLength","h","abortHandshakeOrEmitwsClientError","req","autoPong","perMessageDeflate","handleProtocols","clientTracking","verifyClient","noServer","backlog","host","port","_server","createServer","res","body","writeHead","listen","emitConnection","bind","_removeListeners","event","addListeners","listening","upgrade","head","handleUpgrade","clients","_shouldEmitClose","address","size","shouldHandle","index","url","indexOf","version","method","toLowerCase","secWebSocketProtocol","secWebSocketExtensions","info","origin","secure","authorized","encrypted","verified","completeUpgrade","readable","writable","update","digest","next","_protocol","setSocket","delete","mask","source","output","addon","randomFillSync","isBlob","applyMask","toBuffer","kByteLength","maskBuffer","RANDOM_POOL_SIZE","randomPool","randomPoolPointer","Sender","generateMask","_generateMask","_maskBuffer","_firstFragment","_queue","onerror","frame","dataLength","merge","skipMasking","readOnly","payloadLength","opcode","rsv1","writeUInt16BE","writeUIntBE","enqueue","dispatch","sendFrame","ping","getBlobData","pong","binary","blob","arrayBuffer","then","callCallbacks","dequeue","catch","onError","_","Reflect","apply","list","cork","uncork","sender","kCode","kData","kMessage","kReason","kTarget","kType","kWasClean","Event","defineProperty","prototype","enumerable","CloseEvent","reason","wasClean","ErrorEvent","MessageEvent","EventTarget","addEventListener","handler","listener","listeners","wrapper","callListener","_closeFrameReceived","_closeFrameSent","removeEventListener","thisArg","handleEvent","call","https","net","tls","randomBytes","Readable","URL","Receiver","kAborted","protocolVersions","readyStates","subprotocolRegex","_closeCode","_closeMessage","_closeTimer","_errorEmitted","_paused","_readyState","_receiver","_sender","_bufferedAmount","_redirects","initAsClient","_autoPong","bufferedAmount","onclose","onopen","onmessage","_url","receiver","receiverOnConclude","receiverOnDrain","receiverOnError","receiverOnMessage","receiverOnPing","receiverOnPong","senderOnError","setTimeout","setNoDelay","unshift","socketOnClose","socketOnData","socketOnEnd","OPEN","removeAllListeners","CLOSING","errorEmitted","setCloseTimer","_req","sendAfterClose","needDrain","websocket","protocolVersion","followRedirects","maxRedirects","socketPath","hostname","timeout","parsedUrl","href","isSecure","isIpcUrl","invalidUrlMessage","pathname","hash","emitErrorAndClose","defaultPort","request","protocolSet","createConnection","tlsConnect","netConnect","startsWith","Upgrade","search","handshakeTimeout","Origin","username","password","auth","parts","_originalIpc","_originalSecure","_originalHostOrSocketPath","entries","isSameHost","authorization","cookie","location","addr","abort","serverProt","protError","extensionNames","finishRequest","connect","servername","isIP","setHeader","receiverOnFinish","read","clearTimeout","property","get","_unmask","totalLength","isBuffer","ArrayBuffer","isView","WS_NO_BUFFER_UTIL","isUtf8","_isValidUTF8","len","toStringTag","WS_NO_UTF_8_VALIDATE"],"sourceRoot":""}